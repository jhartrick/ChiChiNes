!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e(require("rxjs/Subject")):"function"==typeof define&&define.amd?define(["rxjs/Subject"],e):"object"==typeof exports?exports.chichi=e(require("rxjs/Subject")):t.chichi=e(t.Rx)}("undefined"!=typeof self?self:this,function(t){return function(t){var e={};function s(r){if(e[r])return e[r].exports;var i=e[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,s),i.l=!0,i.exports}return s.m=t,s.c=e,s.d=function(t,e,r){s.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:r})},s.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return s.d(e,"a",e),e},s.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},s.p="",s(s.s=12)}([function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0}),function(t){t[t.OneScreen=0]="OneScreen",t[t.Vertical=1]="Vertical",t[t.Horizontal=2]="Horizontal",t[t.FourScreen=3]="FourScreen"}(e.NameTableMirroring||(e.NameTableMirroring={}));var n=function(){function t(t){var e=this;this.romFile=t,this.batterySRAM=!1,this.ramMask=8191,this.fileName="",this.oneScreenOffset=0,this.fourScreen=!1,this.mapperName="base",this.supported=!0,this.submapperId=0,this.mapsBelow6000=!1,this.nextEventAt=0,this.prgRomCount=0,this.chrRomOffset=0,this.chrRomCount=0,this.chrRamStart=0,this.chrRamLength=0,this.mapperId=0,this.chrRam=new Uint8Array(8192),this.prgRomBank6=new Uint8Array(8192),this.ppuBankStarts=new Uint32Array(16),this.prgBankStarts=new Uint32Array(10),this.SRAMCanWrite=!1,this.SRAMEnabled=!1,this.SRAMCanSave=!1,this.ROMHashFunction=null,this.mirroring=-1,this.updateIRQ=function(){e.NMIHandler()},this.irqRaised=!1,this.usesSRAM=!1,this.loadFile(t)}return t.prototype.setupMapperStateBuffer=function(t,e){},t.prototype.advanceClock=function(t){},Object.defineProperty(t.prototype,"current6",{get:function(){return this.prgBankStarts[0]/8192},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"current8",{get:function(){return this.prgBankStarts[2]/8192},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentA",{get:function(){return this.prgBankStarts[4]/8192},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentC",{get:function(){return this.prgBankStarts[6]/8192},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"currentE",{get:function(){return this.prgBankStarts[8]/8192},enumerable:!0,configurable:!0}),t.prototype.setupStateBuffer=function(t){var e=this;return t.onRestore.subscribe(function(t){e.attachStateBuffer(t)}),t.pushSegment(8192,"prgram").pushSegment(10*Uint32Array.BYTES_PER_ELEMENT,"prgbankstarts").pushSegment(16*Uint32Array.BYTES_PER_ELEMENT,"ppubankstarts").pushSegment(0===this.romFile.chrRomCount?8192:0,"chrrom").pushSegment(8192,"chrram"),t},t.prototype.attachStateBuffer=function(t){var e=t.getSegment("prgram");this.prgRomBank6=new Uint8Array(e.buffer,e.start,e.size),e=t.getSegment("prgbankstarts"),this.prgBankStarts=new Uint32Array(e.buffer,e.start,10),e=t.getSegment("chrram"),this.chrRam=new Uint8Array(e.buffer,e.start,e.size),e=t.getSegment("ppubankstarts"),this.ppuBankStarts=new Uint32Array(e.buffer,e.start,16),(e=t.getSegment("chrrom")).size>0&&(this.chrRom=new Uint8Array(e.buffer,e.start,e.size))},t.prototype.loadFile=function(t){this.prgRomCount=t.prgRomCount,this.chrRomCount=t.chrRomCount,this.prgRom=t.prgRom,t.chrRomCount>0&&(this.chrRom=t.chrRom,this.chrRamStart=t.chrRomLength),this.chrRamLength=8192,this.usesSRAM=t.usesSRAM,this.batterySRAM=t.batterySRAM,this.ROMHashFunction=t.romCRC,this.mirroring=t.mirroring,this.fourScreen=t.fourScreen},t.prototype.installCart=function(t,e){this.Whizzler=t,this.CPU=e,this.prgRomBank6.fill(0);for(var s=0;s<16;s++)this.ppuBankStarts[s]=1024*s;for(s=0;s<8;s++)this.prgBankStarts[s]=4096*s;this.mirroring=this.romFile.mirroring,this.mirror(0,this.mirroring),this.initializeCart()},t.prototype.getByte=function(t,e){var s=(e>>12)-6;return s<2?this.usesSRAM?this.prgRomBank6[e&this.ramMask]:e>>8&255:this.prgRom[this.prgBankStarts[s]+(4095&e)]},t.prototype.peekByte=function(t){return this.prgRom[this.prgBankStarts[(t>>12)-6]+(4095&t)]},t.prototype.setPrgRam=function(t,e){t>=24576&&t<=32767&&(this.prgRomBank6[8191&t]=e)},t.prototype.setByte=function(t,e,s){this.usesSRAM&&this.setPrgRam(e,s)},t.prototype.getPPUByte=function(t,e){var s=e>>10,r=this.ppuBankStarts[s]+(1023&e);return s<8?this.chrRom[r]:this.chrRam[8191&r]},t.prototype.setPPUByte=function(t,e,s){var r=e>>10,i=this.ppuBankStarts[r]+(1023&e);r<8?this.chrRom[i]=s:this.chrRam[8191&i]=s},t.prototype.setup6BankStarts=function(t,e,s,r,i){t%=2*this.prgRomCount,this.prgBankStarts[0]=8192*t,this.prgBankStarts[1]=this.prgBankStarts[0]+4096,this.setupBankStarts(e,s,r,i)},t.prototype.setupBankStarts=function(t,e,s,r){t%=2*this.prgRomCount,e%=2*this.prgRomCount,s%=2*this.prgRomCount,r%=2*this.prgRomCount,this.prgBankStarts[2]=8192*t,this.prgBankStarts[3]=this.prgBankStarts[2]+4096,this.prgBankStarts[4]=8192*e,this.prgBankStarts[5]=this.prgBankStarts[4]+4096,this.prgBankStarts[6]=8192*s,this.prgBankStarts[7]=this.prgBankStarts[6]+4096,this.prgBankStarts[8]=8192*r,this.prgBankStarts[9]=this.prgBankStarts[8]+4096},t.prototype.setupBanks4k=function(t,e){var s=this;e=e.map(function(t){return t%(s.prgRomCount<<2)});for(var r=0;r<e.length&&!(r>=this.prgBankStarts.length);++r)this.prgBankStarts[t+r]=4096*e[r]},t.prototype.maskBankAddress=function(t){return t%(2*this.prgRomCount)},t.prototype.mirror=function(t,e){switch(this.mirroring=e,e){case 0:this.ppuBankStarts[8]=this.chrRamStart+this.oneScreenOffset,this.ppuBankStarts[9]=this.chrRamStart+this.oneScreenOffset,this.ppuBankStarts[10]=this.chrRamStart+this.oneScreenOffset,this.ppuBankStarts[11]=this.chrRamStart+this.oneScreenOffset;break;case 1:this.ppuBankStarts[8]=this.chrRamStart+0,this.ppuBankStarts[9]=this.chrRamStart+1024,this.ppuBankStarts[10]=this.chrRamStart+0,this.ppuBankStarts[11]=this.chrRamStart+1024;break;case 2:this.ppuBankStarts[8]=this.chrRamStart+0,this.ppuBankStarts[9]=this.chrRamStart+0,this.ppuBankStarts[10]=this.chrRamStart+1024,this.ppuBankStarts[11]=this.chrRamStart+1024;break;case 3:this.ppuBankStarts[8]=this.chrRamStart+0,this.ppuBankStarts[9]=this.chrRamStart+1024,this.ppuBankStarts[10]=this.chrRamStart+2048,this.ppuBankStarts[11]=this.chrRamStart+3072}},t.prototype.copyBanks=function(t,e,s,r){e>=this.chrRomCount&&(e%=this.chrRomCount),s>=this.chrRomCount&&(s%=this.chrRomCount);for(var i=s<<3,n=e<<3,a=0;a<r<<3;a++)this.ppuBankStarts[n+a]=1024*(i+a)},t.prototype.copyBanks4k=function(t,e,s,r){var i=this.chrRomCount<<1;e>=i&&(e%=i),s>=i&&(s%=i);for(var n=s<<2,a=e<<2,o=0;o<r<<2;o++)this.ppuBankStarts[a+o]=1024*(n+o)},t.prototype.copyBanks2k=function(t,e,s,r){var i=this.chrRomCount<<2;e>=i&&(e%=i),s>=i&&(s%=i);for(var n=s<<1,a=e<<1,o=0;o<r<<1;o++)this.ppuBankStarts[a+o]=1024*(n+o)},t.prototype.copyBanks1k=function(t,e,s,r){var i=this.chrRomCount<<3;e>=i&&(e%=i),s>=i&&(s%=i);for(var n=s,a=e,o=0;o<r;o++)this.ppuBankStarts[a+o]=1024*(n+o)},t.prototype.initializeCart=function(t){this.mirroring=this.romFile.mirroring,this.fourScreen=this.romFile.fourScreen,this.mirror(0,this.mirroring)},t.prototype.updateScanlineCounter=function(){},t}();e.BaseCart=n;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.supported=!1,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="unsupported",this.setupBankStarts(0,1,(this.prgRomCount<<1)-2,(this.prgRomCount<<1)-1),this.mirror(0,0)},e}(n);e.UnsupportedCart=a},function(t,e,s){"use strict";(function(t){var r=s(45),i=s(46),n=s(47);function a(){return h.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function o(t,e){if(a()<e)throw new RangeError("Invalid typed array length");return h.TYPED_ARRAY_SUPPORT?(t=new Uint8Array(e)).__proto__=h.prototype:(null===t&&(t=new h(e)),t.length=e),t}function h(t,e,s){if(!(h.TYPED_ARRAY_SUPPORT||this instanceof h))return new h(t,e,s);if("number"==typeof t){if("string"==typeof e)throw new Error("If encoding is specified then the first argument must be a string");return p(this,t)}return c(this,t,e,s)}function c(t,e,s,r){if("number"==typeof e)throw new TypeError('"value" argument must not be a number');return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer?function(t,e,s,r){if(e.byteLength,s<0||e.byteLength<s)throw new RangeError("'offset' is out of bounds");if(e.byteLength<s+(r||0))throw new RangeError("'length' is out of bounds");e=void 0===s&&void 0===r?new Uint8Array(e):void 0===r?new Uint8Array(e,s):new Uint8Array(e,s,r);h.TYPED_ARRAY_SUPPORT?(t=e).__proto__=h.prototype:t=f(t,e);return t}(t,e,s,r):"string"==typeof e?function(t,e,s){"string"==typeof s&&""!==s||(s="utf8");if(!h.isEncoding(s))throw new TypeError('"encoding" must be a valid string encoding');var r=0|d(e,s),i=(t=o(t,r)).write(e,s);i!==r&&(t=t.slice(0,i));return t}(t,e,s):function(t,e){if(h.isBuffer(e)){var s=0|l(e.length);return 0===(t=o(t,s)).length?t:(e.copy(t,0,0,s),t)}if(e){if("undefined"!=typeof ArrayBuffer&&e.buffer instanceof ArrayBuffer||"length"in e)return"number"!=typeof e.length||(r=e.length)!=r?o(t,0):f(t,e);if("Buffer"===e.type&&n(e.data))return f(t,e.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(t,e)}function u(t){if("number"!=typeof t)throw new TypeError('"size" argument must be a number');if(t<0)throw new RangeError('"size" argument must not be negative')}function p(t,e){if(u(e),t=o(t,e<0?0:0|l(e)),!h.TYPED_ARRAY_SUPPORT)for(var s=0;s<e;++s)t[s]=0;return t}function f(t,e){var s=e.length<0?0:0|l(e.length);t=o(t,s);for(var r=0;r<s;r+=1)t[r]=255&e[r];return t}function l(t){if(t>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|t}function d(t,e){if(h.isBuffer(t))return t.length;if("undefined"!=typeof ArrayBuffer&&"function"==typeof ArrayBuffer.isView&&(ArrayBuffer.isView(t)||t instanceof ArrayBuffer))return t.byteLength;"string"!=typeof t&&(t=""+t);var s=t.length;if(0===s)return 0;for(var r=!1;;)switch(e){case"ascii":case"latin1":case"binary":return s;case"utf8":case"utf-8":case void 0:return q(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*s;case"hex":return s>>>1;case"base64":return L(t).length;default:if(r)return q(t).length;e=(""+e).toLowerCase(),r=!0}}function y(t,e,s){var r=t[e];t[e]=t[s],t[s]=r}function m(t,e,s,r,i){if(0===t.length)return-1;if("string"==typeof s?(r=s,s=0):s>2147483647?s=2147483647:s<-2147483648&&(s=-2147483648),s=+s,isNaN(s)&&(s=i?0:t.length-1),s<0&&(s=t.length+s),s>=t.length){if(i)return-1;s=t.length-1}else if(s<0){if(!i)return-1;s=0}if("string"==typeof e&&(e=h.from(e,r)),h.isBuffer(e))return 0===e.length?-1:g(t,e,s,r,i);if("number"==typeof e)return e&=255,h.TYPED_ARRAY_SUPPORT&&"function"==typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(t,e,s):Uint8Array.prototype.lastIndexOf.call(t,e,s):g(t,[e],s,r,i);throw new TypeError("val must be string, number or Buffer")}function g(t,e,s,r,i){var n,a=1,o=t.length,h=e.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(t.length<2||e.length<2)return-1;a=2,o/=2,h/=2,s/=2}function c(t,e){return 1===a?t[e]:t.readUInt16BE(e*a)}if(i){var u=-1;for(n=s;n<o;n++)if(c(t,n)===c(e,-1===u?0:n-u)){if(-1===u&&(u=n),n-u+1===h)return u*a}else-1!==u&&(n-=n-u),u=-1}else for(s+h>o&&(s=o-h),n=s;n>=0;n--){for(var p=!0,f=0;f<h;f++)if(c(t,n+f)!==c(e,f)){p=!1;break}if(p)return n}return-1}function C(t,e,s,r){s=Number(s)||0;var i=t.length-s;r?(r=Number(r))>i&&(r=i):r=i;var n=e.length;if(n%2!=0)throw new TypeError("Invalid hex string");r>n/2&&(r=n/2);for(var a=0;a<r;++a){var o=parseInt(e.substr(2*a,2),16);if(isNaN(o))return a;t[s+a]=o}return a}function k(t,e,s,r){return z(q(e,t.length-s),t,s,r)}function B(t,e,s,r){return z(function(t){for(var e=[],s=0;s<t.length;++s)e.push(255&t.charCodeAt(s));return e}(e),t,s,r)}function b(t,e,s,r){return B(t,e,s,r)}function S(t,e,s,r){return z(L(e),t,s,r)}function _(t,e,s,r){return z(function(t,e){for(var s,r,i,n=[],a=0;a<t.length&&!((e-=2)<0);++a)s=t.charCodeAt(a),r=s>>8,i=s%256,n.push(i),n.push(r);return n}(e,t.length-s),t,s,r)}function v(t,e,s){return 0===e&&s===t.length?r.fromByteArray(t):r.fromByteArray(t.slice(e,s))}function R(t,e,s){s=Math.min(t.length,s);for(var r=[],i=e;i<s;){var n,a,o,h,c=t[i],u=null,p=c>239?4:c>223?3:c>191?2:1;if(i+p<=s)switch(p){case 1:c<128&&(u=c);break;case 2:128==(192&(n=t[i+1]))&&(h=(31&c)<<6|63&n)>127&&(u=h);break;case 3:n=t[i+1],a=t[i+2],128==(192&n)&&128==(192&a)&&(h=(15&c)<<12|(63&n)<<6|63&a)>2047&&(h<55296||h>57343)&&(u=h);break;case 4:n=t[i+1],a=t[i+2],o=t[i+3],128==(192&n)&&128==(192&a)&&128==(192&o)&&(h=(15&c)<<18|(63&n)<<12|(63&a)<<6|63&o)>65535&&h<1114112&&(u=h)}null===u?(u=65533,p=1):u>65535&&(u-=65536,r.push(u>>>10&1023|55296),u=56320|1023&u),r.push(u),i+=p}return function(t){var e=t.length;if(e<=P)return String.fromCharCode.apply(String,t);var s="",r=0;for(;r<e;)s+=String.fromCharCode.apply(String,t.slice(r,r+=P));return s}(r)}e.Buffer=h,e.SlowBuffer=function(t){+t!=t&&(t=0);return h.alloc(+t)},e.INSPECT_MAX_BYTES=50,h.TYPED_ARRAY_SUPPORT=void 0!==t.TYPED_ARRAY_SUPPORT?t.TYPED_ARRAY_SUPPORT:function(){try{var t=new Uint8Array(1);return t.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===t.foo()&&"function"==typeof t.subarray&&0===t.subarray(1,1).byteLength}catch(t){return!1}}(),e.kMaxLength=a(),h.poolSize=8192,h._augment=function(t){return t.__proto__=h.prototype,t},h.from=function(t,e,s){return c(null,t,e,s)},h.TYPED_ARRAY_SUPPORT&&(h.prototype.__proto__=Uint8Array.prototype,h.__proto__=Uint8Array,"undefined"!=typeof Symbol&&Symbol.species&&h[Symbol.species]===h&&Object.defineProperty(h,Symbol.species,{value:null,configurable:!0})),h.alloc=function(t,e,s){return function(t,e,s,r){return u(e),e<=0?o(t,e):void 0!==s?"string"==typeof r?o(t,e).fill(s,r):o(t,e).fill(s):o(t,e)}(null,t,e,s)},h.allocUnsafe=function(t){return p(null,t)},h.allocUnsafeSlow=function(t){return p(null,t)},h.isBuffer=function(t){return!(null==t||!t._isBuffer)},h.compare=function(t,e){if(!h.isBuffer(t)||!h.isBuffer(e))throw new TypeError("Arguments must be Buffers");if(t===e)return 0;for(var s=t.length,r=e.length,i=0,n=Math.min(s,r);i<n;++i)if(t[i]!==e[i]){s=t[i],r=e[i];break}return s<r?-1:r<s?1:0},h.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},h.concat=function(t,e){if(!n(t))throw new TypeError('"list" argument must be an Array of Buffers');if(0===t.length)return h.alloc(0);var s;if(void 0===e)for(e=0,s=0;s<t.length;++s)e+=t[s].length;var r=h.allocUnsafe(e),i=0;for(s=0;s<t.length;++s){var a=t[s];if(!h.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},h.byteLength=d,h.prototype._isBuffer=!0,h.prototype.swap16=function(){var t=this.length;if(t%2!=0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var e=0;e<t;e+=2)y(this,e,e+1);return this},h.prototype.swap32=function(){var t=this.length;if(t%4!=0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var e=0;e<t;e+=4)y(this,e,e+3),y(this,e+1,e+2);return this},h.prototype.swap64=function(){var t=this.length;if(t%8!=0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var e=0;e<t;e+=8)y(this,e,e+7),y(this,e+1,e+6),y(this,e+2,e+5),y(this,e+3,e+4);return this},h.prototype.toString=function(){var t=0|this.length;return 0===t?"":0===arguments.length?R(this,0,t):function(t,e,s){var r=!1;if((void 0===e||e<0)&&(e=0),e>this.length)return"";if((void 0===s||s>this.length)&&(s=this.length),s<=0)return"";if((s>>>=0)<=(e>>>=0))return"";for(t||(t="utf8");;)switch(t){case"hex":return M(this,e,s);case"utf8":case"utf-8":return R(this,e,s);case"ascii":return A(this,e,s);case"latin1":case"binary":return w(this,e,s);case"base64":return v(this,e,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return O(this,e,s);default:if(r)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),r=!0}}.apply(this,arguments)},h.prototype.equals=function(t){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");return this===t||0===h.compare(this,t)},h.prototype.inspect=function(){var t="",s=e.INSPECT_MAX_BYTES;return this.length>0&&(t=this.toString("hex",0,s).match(/.{2}/g).join(" "),this.length>s&&(t+=" ... ")),"<Buffer "+t+">"},h.prototype.compare=function(t,e,s,r,i){if(!h.isBuffer(t))throw new TypeError("Argument must be a Buffer");if(void 0===e&&(e=0),void 0===s&&(s=t?t.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),e<0||s>t.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&e>=s)return 0;if(r>=i)return-1;if(e>=s)return 1;if(e>>>=0,s>>>=0,r>>>=0,i>>>=0,this===t)return 0;for(var n=i-r,a=s-e,o=Math.min(n,a),c=this.slice(r,i),u=t.slice(e,s),p=0;p<o;++p)if(c[p]!==u[p]){n=c[p],a=u[p];break}return n<a?-1:a<n?1:0},h.prototype.includes=function(t,e,s){return-1!==this.indexOf(t,e,s)},h.prototype.indexOf=function(t,e,s){return m(this,t,e,s,!0)},h.prototype.lastIndexOf=function(t,e,s){return m(this,t,e,s,!1)},h.prototype.write=function(t,e,s,r){if(void 0===e)r="utf8",s=this.length,e=0;else if(void 0===s&&"string"==typeof e)r=e,s=this.length,e=0;else{if(!isFinite(e))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");e|=0,isFinite(s)?(s|=0,void 0===r&&(r="utf8")):(r=s,s=void 0)}var i=this.length-e;if((void 0===s||s>i)&&(s=i),t.length>0&&(s<0||e<0)||e>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var n=!1;;)switch(r){case"hex":return C(this,t,e,s);case"utf8":case"utf-8":return k(this,t,e,s);case"ascii":return B(this,t,e,s);case"latin1":case"binary":return b(this,t,e,s);case"base64":return S(this,t,e,s);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _(this,t,e,s);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),n=!0}},h.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};var P=4096;function A(t,e,s){var r="";s=Math.min(t.length,s);for(var i=e;i<s;++i)r+=String.fromCharCode(127&t[i]);return r}function w(t,e,s){var r="";s=Math.min(t.length,s);for(var i=e;i<s;++i)r+=String.fromCharCode(t[i]);return r}function M(t,e,s){var r=t.length;(!e||e<0)&&(e=0),(!s||s<0||s>r)&&(s=r);for(var i="",n=e;n<s;++n)i+=Y(t[n]);return i}function O(t,e,s){for(var r=t.slice(e,s),i="",n=0;n<r.length;n+=2)i+=String.fromCharCode(r[n]+256*r[n+1]);return i}function E(t,e,s){if(t%1!=0||t<0)throw new RangeError("offset is not uint");if(t+e>s)throw new RangeError("Trying to access beyond buffer length")}function I(t,e,s,r,i,n){if(!h.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<n)throw new RangeError('"value" argument is out of bounds');if(s+r>t.length)throw new RangeError("Index out of range")}function U(t,e,s,r){e<0&&(e=65535+e+1);for(var i=0,n=Math.min(t.length-s,2);i<n;++i)t[s+i]=(e&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function T(t,e,s,r){e<0&&(e=4294967295+e+1);for(var i=0,n=Math.min(t.length-s,4);i<n;++i)t[s+i]=e>>>8*(r?i:3-i)&255}function x(t,e,s,r,i,n){if(s+r>t.length)throw new RangeError("Index out of range");if(s<0)throw new RangeError("Index out of range")}function N(t,e,s,r,n){return n||x(t,0,s,4),i.write(t,e,s,r,23,4),s+4}function F(t,e,s,r,n){return n||x(t,0,s,8),i.write(t,e,s,r,52,8),s+8}h.prototype.slice=function(t,e){var s,r=this.length;if(t=~~t,e=void 0===e?r:~~e,t<0?(t+=r)<0&&(t=0):t>r&&(t=r),e<0?(e+=r)<0&&(e=0):e>r&&(e=r),e<t&&(e=t),h.TYPED_ARRAY_SUPPORT)(s=this.subarray(t,e)).__proto__=h.prototype;else{var i=e-t;s=new h(i,void 0);for(var n=0;n<i;++n)s[n]=this[n+t]}return s},h.prototype.readUIntLE=function(t,e,s){t|=0,e|=0,s||E(t,e,this.length);for(var r=this[t],i=1,n=0;++n<e&&(i*=256);)r+=this[t+n]*i;return r},h.prototype.readUIntBE=function(t,e,s){t|=0,e|=0,s||E(t,e,this.length);for(var r=this[t+--e],i=1;e>0&&(i*=256);)r+=this[t+--e]*i;return r},h.prototype.readUInt8=function(t,e){return e||E(t,1,this.length),this[t]},h.prototype.readUInt16LE=function(t,e){return e||E(t,2,this.length),this[t]|this[t+1]<<8},h.prototype.readUInt16BE=function(t,e){return e||E(t,2,this.length),this[t]<<8|this[t+1]},h.prototype.readUInt32LE=function(t,e){return e||E(t,4,this.length),(this[t]|this[t+1]<<8|this[t+2]<<16)+16777216*this[t+3]},h.prototype.readUInt32BE=function(t,e){return e||E(t,4,this.length),16777216*this[t]+(this[t+1]<<16|this[t+2]<<8|this[t+3])},h.prototype.readIntLE=function(t,e,s){t|=0,e|=0,s||E(t,e,this.length);for(var r=this[t],i=1,n=0;++n<e&&(i*=256);)r+=this[t+n]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*e)),r},h.prototype.readIntBE=function(t,e,s){t|=0,e|=0,s||E(t,e,this.length);for(var r=e,i=1,n=this[t+--r];r>0&&(i*=256);)n+=this[t+--r]*i;return n>=(i*=128)&&(n-=Math.pow(2,8*e)),n},h.prototype.readInt8=function(t,e){return e||E(t,1,this.length),128&this[t]?-1*(255-this[t]+1):this[t]},h.prototype.readInt16LE=function(t,e){e||E(t,2,this.length);var s=this[t]|this[t+1]<<8;return 32768&s?4294901760|s:s},h.prototype.readInt16BE=function(t,e){e||E(t,2,this.length);var s=this[t+1]|this[t]<<8;return 32768&s?4294901760|s:s},h.prototype.readInt32LE=function(t,e){return e||E(t,4,this.length),this[t]|this[t+1]<<8|this[t+2]<<16|this[t+3]<<24},h.prototype.readInt32BE=function(t,e){return e||E(t,4,this.length),this[t]<<24|this[t+1]<<16|this[t+2]<<8|this[t+3]},h.prototype.readFloatLE=function(t,e){return e||E(t,4,this.length),i.read(this,t,!0,23,4)},h.prototype.readFloatBE=function(t,e){return e||E(t,4,this.length),i.read(this,t,!1,23,4)},h.prototype.readDoubleLE=function(t,e){return e||E(t,8,this.length),i.read(this,t,!0,52,8)},h.prototype.readDoubleBE=function(t,e){return e||E(t,8,this.length),i.read(this,t,!1,52,8)},h.prototype.writeUIntLE=function(t,e,s,r){(t=+t,e|=0,s|=0,r)||I(this,t,e,s,Math.pow(2,8*s)-1,0);var i=1,n=0;for(this[e]=255&t;++n<s&&(i*=256);)this[e+n]=t/i&255;return e+s},h.prototype.writeUIntBE=function(t,e,s,r){(t=+t,e|=0,s|=0,r)||I(this,t,e,s,Math.pow(2,8*s)-1,0);var i=s-1,n=1;for(this[e+i]=255&t;--i>=0&&(n*=256);)this[e+i]=t/n&255;return e+s},h.prototype.writeUInt8=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,1,255,0),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),this[e]=255&t,e+1},h.prototype.writeUInt16LE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},h.prototype.writeUInt16BE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,2,65535,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},h.prototype.writeUInt32LE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e+3]=t>>>24,this[e+2]=t>>>16,this[e+1]=t>>>8,this[e]=255&t):T(this,t,e,!0),e+4},h.prototype.writeUInt32BE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,4,4294967295,0),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):T(this,t,e,!1),e+4},h.prototype.writeIntLE=function(t,e,s,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*s-1);I(this,t,e,s,i-1,-i)}var n=0,a=1,o=0;for(this[e]=255&t;++n<s&&(a*=256);)t<0&&0===o&&0!==this[e+n-1]&&(o=1),this[e+n]=(t/a>>0)-o&255;return e+s},h.prototype.writeIntBE=function(t,e,s,r){if(t=+t,e|=0,!r){var i=Math.pow(2,8*s-1);I(this,t,e,s,i-1,-i)}var n=s-1,a=1,o=0;for(this[e+n]=255&t;--n>=0&&(a*=256);)t<0&&0===o&&0!==this[e+n+1]&&(o=1),this[e+n]=(t/a>>0)-o&255;return e+s},h.prototype.writeInt8=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,1,127,-128),h.TYPED_ARRAY_SUPPORT||(t=Math.floor(t)),t<0&&(t=255+t+1),this[e]=255&t,e+1},h.prototype.writeInt16LE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8):U(this,t,e,!0),e+2},h.prototype.writeInt16BE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,2,32767,-32768),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>8,this[e+1]=255&t):U(this,t,e,!1),e+2},h.prototype.writeInt32LE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,4,2147483647,-2147483648),h.TYPED_ARRAY_SUPPORT?(this[e]=255&t,this[e+1]=t>>>8,this[e+2]=t>>>16,this[e+3]=t>>>24):T(this,t,e,!0),e+4},h.prototype.writeInt32BE=function(t,e,s){return t=+t,e|=0,s||I(this,t,e,4,2147483647,-2147483648),t<0&&(t=4294967295+t+1),h.TYPED_ARRAY_SUPPORT?(this[e]=t>>>24,this[e+1]=t>>>16,this[e+2]=t>>>8,this[e+3]=255&t):T(this,t,e,!1),e+4},h.prototype.writeFloatLE=function(t,e,s){return N(this,t,e,!0,s)},h.prototype.writeFloatBE=function(t,e,s){return N(this,t,e,!1,s)},h.prototype.writeDoubleLE=function(t,e,s){return F(this,t,e,!0,s)},h.prototype.writeDoubleBE=function(t,e,s){return F(this,t,e,!1,s)},h.prototype.copy=function(t,e,s,r){if(s||(s=0),r||0===r||(r=this.length),e>=t.length&&(e=t.length),e||(e=0),r>0&&r<s&&(r=s),r===s)return 0;if(0===t.length||0===this.length)return 0;if(e<0)throw new RangeError("targetStart out of bounds");if(s<0||s>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),t.length-e<r-s&&(r=t.length-e+s);var i,n=r-s;if(this===t&&s<e&&e<r)for(i=n-1;i>=0;--i)t[i+e]=this[i+s];else if(n<1e3||!h.TYPED_ARRAY_SUPPORT)for(i=0;i<n;++i)t[i+e]=this[i+s];else Uint8Array.prototype.set.call(t,this.subarray(s,s+n),e);return n},h.prototype.fill=function(t,e,s,r){if("string"==typeof t){if("string"==typeof e?(r=e,e=0,s=this.length):"string"==typeof s&&(r=s,s=this.length),1===t.length){var i=t.charCodeAt(0);i<256&&(t=i)}if(void 0!==r&&"string"!=typeof r)throw new TypeError("encoding must be a string");if("string"==typeof r&&!h.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"==typeof t&&(t&=255);if(e<0||this.length<e||this.length<s)throw new RangeError("Out of range index");if(s<=e)return this;var n;if(e>>>=0,s=void 0===s?this.length:s>>>0,t||(t=0),"number"==typeof t)for(n=e;n<s;++n)this[n]=t;else{var a=h.isBuffer(t)?t:q(new h(t,r).toString()),o=a.length;for(n=0;n<s-e;++n)this[n+e]=a[n%o]}return this};var j=/[^+\/0-9A-Za-z-_]/g;function Y(t){return t<16?"0"+t.toString(16):t.toString(16)}function q(t,e){var s;e=e||1/0;for(var r=t.length,i=null,n=[],a=0;a<r;++a){if((s=t.charCodeAt(a))>55295&&s<57344){if(!i){if(s>56319){(e-=3)>-1&&n.push(239,191,189);continue}if(a+1===r){(e-=3)>-1&&n.push(239,191,189);continue}i=s;continue}if(s<56320){(e-=3)>-1&&n.push(239,191,189),i=s;continue}s=65536+(i-55296<<10|s-56320)}else i&&(e-=3)>-1&&n.push(239,191,189);if(i=null,s<128){if((e-=1)<0)break;n.push(s)}else if(s<2048){if((e-=2)<0)break;n.push(s>>6|192,63&s|128)}else if(s<65536){if((e-=3)<0)break;n.push(s>>12|224,s>>6&63|128,63&s|128)}else{if(!(s<1114112))throw new Error("Invalid code point");if((e-=4)<0)break;n.push(s>>18|240,s>>12&63|128,s>>6&63|128,63&s|128)}}return n}function L(t){return r.toByteArray(function(t){if((t=function(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}(t).replace(j,"")).length<2)return"";for(;t.length%4!=0;)t+="=";return t}(t))}function z(t,e,s,r){for(var i=0;i<r&&!(i+s>=e.length||i>=t.length);++i)e[i+s]=t[i];return i}}).call(e,s(44))},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(1),i=r.Buffer.from&&r.Buffer.alloc&&r.Buffer.allocUnsafe&&r.Buffer.allocUnsafeSlow?r.Buffer.from:function(t){return new r.Buffer(t)};e.default=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(t,e){var s=function(t,s){return e(t,s)>>>0};return s.signed=e,s.unsigned=s,s.model=t,s}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(){}return t.MakeUint32Array=function(t){return new Uint32Array(t)},t.MakeUint8Array=function(t){return new Uint8Array(t)},t}();e.BufferMaker=r,function(t){t[t.Unloaded=0]="Unloaded",t[t.Off=1]="Off",t[t.Running=2]="Running",t[t.Frozen=3]="Frozen",t[t.Paused=4]="Paused"}(e.RunningStatuses||(e.RunningStatuses={})),function(t){t[t.Instruction=0]="Instruction",t[t.Frame=1]="Frame"}(e.DebugStepTypes||(e.DebugStepTypes={})),function(t){t[t.Bullshit=0]="Bullshit",t[t.Implicit=1]="Implicit",t[t.Accumulator=2]="Accumulator",t[t.Immediate=3]="Immediate",t[t.ZeroPage=4]="ZeroPage",t[t.ZeroPageX=5]="ZeroPageX",t[t.ZeroPageY=6]="ZeroPageY",t[t.Relative=7]="Relative",t[t.Absolute=8]="Absolute",t[t.AbsoluteX=9]="AbsoluteX",t[t.AbsoluteY=10]="AbsoluteY",t[t.Indirect=11]="Indirect",t[t.IndexedIndirect=12]="IndexedIndirect",t[t.IndirectIndexed=13]="IndirectIndexed",t[t.IndirectZeroPage=14]="IndirectZeroPage",t[t.IndirectAbsoluteX=15]="IndirectAbsoluteX"}(e.ChiChiCPPU_AddressingModes||(e.ChiChiCPPU_AddressingModes={}));var i=function(){return function(){this.PC=0,this.A=0,this.X=0,this.Y=0,this.SP=0,this.SR=0}}();e.CpuStatus=i;var n=function(){return function(){this.status=0,this.controlByte0=0,this.controlByte1=0,this.nameTableStart=0,this.currentTile=0,this.lockedVScroll=0,this.lockedHScroll=0,this.X=0,this.Y=0}}();e.PpuStatus=n;var a=function(){return function(){this.AddressingMode=0,this.frame=0,this.time=0,this.A=0,this.X=0,this.Y=0,this.SR=0,this.SP=0,this.Address=0,this.OpCode=0,this.Parameters0=0,this.Parameters1=0,this.ExtraTiming=0,this.Length=0}}();e.ChiChiInstruction=a;var o=function(){return function(){this.YPosition=0,this.XPosition=0,this.SpriteNumber=0,this.Foreground=!1,this.IsVisible=!1,this.TileIndex=0,this.AttributeByte=0,this.FlipX=!1,this.FlipY=!1,this.Changed=!1}}();e.ChiChiSprite=o},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(14),i=s(15),n=s(16),a=s(17),o=function(){function t(t){this.writer=t,this.frameMode=!1,this.pulseTable=[],this.tndTable=[],this.throwingIRQs=!1,this.reg15=0,this._sampleRate=44100,this.muted=!1,this.lastFrameHit=0,this.currentClock=0,this.frameClocker=0,this._interruptRaised=!1,this.sequence4=[7457,14913,22371,29828,29829,29831],this.sequence5=[7457,14913,22371,29828,37282,37283],this.lastOutput=0,this.rebuildSound();for(var e=0;e<31;++e)this.pulseTable.push(95.52/(8128/e+100));for(e=0;e<203;++e)this.tndTable.push(163.67/(24329/e+100))}return t.prototype.irqHandler=function(){},Object.defineProperty(t.prototype,"audioSettings",{get:function(){return{sampleRate:this._sampleRate,master_volume:1,enableSquare0:this.square0.playing,enableSquare1:this.square1.playing,enableTriangle:this.triangle.playing,enableNoise:this.noise.playing,enableDMC:this.dmc.playing,synced:this.writer.synced}},set:function(t){this.noise.playing=t.enableNoise,this.dmc.playing=t.enableDMC,this.square0.playing=t.enableSquare0,this.square1.playing=t.enableSquare1,this.triangle.playing=t.enableTriangle,this.writer.synced=t.synced,t.sampleRate!=this._sampleRate&&(this._sampleRate=t.sampleRate)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sampleRate",{get:function(){return this._sampleRate},set:function(t){this._sampleRate=t,this.rebuildSound()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"interruptRaised",{get:function(){return this._interruptRaised||this.dmc.interruptRaised},set:function(t){this._interruptRaised=t},enumerable:!0,configurable:!0}),t.prototype.rebuildSound=function(){var e=this;this.writer.blip_new(this._sampleRate/5),this.writer.blip_set_rates(t.clock_rate,this._sampleRate),this.writer.audioBytesWritten=0,this.square0=new i.SquareChannel(0,function(t){return e.mixAndOutputAudio(t)}),this.square0.period=10,this.square0.sweepComplement=!0,this.square1=new i.SquareChannel(1,function(t){return e.mixAndOutputAudio(t)}),this.square1.period=10,this.square1.sweepComplement=!1,this.triangle=new n.TriangleChannel(2,function(t){return e.mixAndOutputAudio(t)}),this.triangle.period=0,this.noise=new a.NoiseChannel(3,function(t){return e.mixAndOutputAudio(t)}),this.noise.period=0,this.dmc=new r.DMCChannel(4,function(t){return e.mixAndOutputAudio(t)},function(t){return e.memoryMap.cpu.borrowedCycles+=4,e.memoryMap.getByte(0,t)})},t.prototype.GetByte=function(t,e){if(16384===e&&(this._interruptRaised=!1),16405===e){var s=(this.dmc.interruptRaised?128:0)|(this.interruptRaised?64:0)|(this.dmc.length>0?16:0)|(this.square0.length>0?1:0)|(this.square1.length>0?2:0)|(this.triangle.length>0?4:0)|(this.square0.length>0?8:0)|(this._interruptRaised?64:0);return this.interruptRaised=!1,s}return 66},t.prototype.SetByte=function(t,e,s){switch(16384===e&&(this._interruptRaised=!1),e){case 16384:case 16385:case 16386:case 16387:this.square0.writeRegister(e-16384,s,t);break;case 16388:case 16389:case 16390:case 16391:this.square1.writeRegister(e-16388,s,t);break;case 16392:case 16393:case 16394:case 16395:this.triangle.writeRegister(e-16392,s,t);break;case 16396:case 16397:case 16398:case 16399:this.noise.writeRegister(e-16396,s,t);break;case 16400:case 16401:case 16402:case 16403:this.dmc.writeRegister(e-16400,s,t),this.dmc.run(this.currentClock);break;case 16405:this.reg15=s,this.square0.writeRegister(4,1&s,t),this.square1.writeRegister(4,2&s,t),this.triangle.writeRegister(4,4&s,t),this.noise.writeRegister(4,8&s,t),this.dmc.writeRegister(4,16&s,t);break;case 16407:this.throwingIRQs=64!=(64&s),this.frameMode=128==(128&s),this.memoryMap.cpu.borrowedCycles+=2}},t.prototype.advanceClock=function(t){this.currentClock+=t,this.frameClocker+=t;var e=this.frameMode?this.sequence5[this.lastFrameHit]:this.sequence4[this.lastFrameHit];this.frameClocker>=e&&this.updateFrame(this.currentClock)},t.prototype.updateFrame=function(t){this.runFrameEvents(t,this.lastFrameHit),this.lastFrameHit>=(this.frameMode?4:3)?(this.lastFrameHit=0,this.frameClocker=0,this.endFrame(t),this.throwingIRQs&&!this.frameMode&&(this._interruptRaised=!0,this.irqHandler())):this.lastFrameHit++},t.prototype.runFrameEvents=function(t,e){this.triangle.frameClock(t,e),this.noise.frameClock(t,e),this.square0.frameClock(t,e),this.square1.frameClock(t,e)},t.prototype.endFrame=function(t){this.square0.endFrame(t),this.square1.endFrame(t),this.triangle.endFrame(t),this.noise.endFrame(t),this.dmc.endFrame(t),this.writer.blip_end_frame(t),this.writer.readElementsLoop(),this.currentClock=0},t.prototype.mixAndOutputAudio=function(t){var e=this.pulseTable[this.square0.output+this.square1.output],s=65536*(e+=this.tndTable[3*this.triangle.output+2*this.noise.output+this.dmc.output])-this.lastOutput;this.lastOutput+=s,this.writer.blip_add_delta(t,s)},t.clock_rate=1789772.727,t}();e.ChiChiAPU=o},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(4),i=new Uint32Array([7961465,10626572,11407400,10554206,7733552,2753820,725017,271983,278855,284436,744967,3035906,7161605,0,131586,131586,12566719,14641430,15614283,14821245,12196292,6496468,2176980,875189,293472,465210,1597716,5906953,11090185,2961197,197379,197379,16316149,16298569,16588080,16415170,15560682,12219892,7115511,4563694,2277591,2151458,4513360,1957181,14604331,6579811,263172,263172,16447992,16441012,16634316,16500447,16236786,14926838,12831991,11393781,2287340,5500370,11858360,14283440,15921318,13158344,328965,328965,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),n=function(){function t(){this.LastcpuClock=0,this.greyScale=!1,this.yPosition=0,this.xPosition=0,this.currentAttributeByte=0,this.spriteSize=0,this.spritesOnThisScanline=0,this._spriteCopyHasHappened=!1,this.spriteZeroHit=!1,this.emphasisBits=0,this.isForegroundPixel=!1,this.spriteChanges=!1,this.ppuReadBuffer=0,this.clipSprites=!1,this.clipTiles=!1,this.tilesVisible=!1,this.spritesVisible=!1,this.nameTableMemoryStart=0,this.backgroundPatternTableIndex=0,this.address=0,this.status=0,this.controlByte0=0,this.controlByte1=0,this.spriteAddress=0,this.currentXPosition=0,this.currentYPosition=0,this.hScroll=0,this.vScroll=0,this.lockedHScroll=0,this.lockedVScroll=0,this.shouldRender=!1,this.framesRun=0,this.hitSprite=!1,this.addressLatchIsHigh=!0,this.isRendering=!0,this.frameClock=0,this.oddFrame=!0,this.frameOn=!1,this.nameTableBits=0,this.palette=new Uint8Array(32),this.openBus=0,this.xNTXor=0,this.yNTXor=0,this.spriteRAMBuffer=new ArrayBuffer(256*Uint8Array.BYTES_PER_ELEMENT),this.spriteRAM=new Uint8Array(this.spriteRAMBuffer),this.spritesOnLine=new Array(512),this.currentTileIndex=0,this.fetchTile=!0,this.patternEntry=0,this.patternEntryByte2=0,this.pixelBuffer=a()(new ArrayBuffer(262144)),this.initSprites()}return t.prototype.GetPPUStatus=function(){return{status:this.status,controlByte0:this.controlByte0,controlByte1:this.controlByte1,nameTableStart:this.nameTableMemoryStart,currentTile:this.currentTileIndex,lockedVScroll:this.lockedVScroll,lockedHScroll:this.lockedHScroll,X:this.currentXPosition,Y:this.currentYPosition}},Object.defineProperty(t.prototype,"PatternTableIndex",{get:function(){return this.backgroundPatternTableIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"SpritePatternTableIndex",{get:function(){var t=0;return 32==(32&this.controlByte0)&&(t=4096),t},enumerable:!0,configurable:!0}),t.prototype.initialize=function(){this.address=0,this.status=0,this.controlByte0=0,this.controlByte1=0,this.hScroll=0,this.vScroll=0,this.spriteAddress=0,this.initSprites()},t.prototype.setupVINT=function(){this.status=128|this.status,this.framesRun=this.framesRun+1,128&this.controlByte0&&(this.cpu.handleNMI=!0)},t.prototype.setByte=function(t,e,s){switch(7&e){case 0:this.controlByte0=s,this.openBus=s,this.nameTableBits=3&this.controlByte0,this.backgroundPatternTableIndex=4096*((16&this.controlByte0)>>4),this.nameTableMemoryStart=1024*this.nameTableBits;break;case 1:this.isRendering=0!=(24&s),this.controlByte1=s,this.emphasisBits=this.controlByte1>>5&7,this.greyScale=1==(1&this.controlByte1),this.clipTiles=2!=(2&this.controlByte1),this.clipSprites=4!=(4&this.controlByte1),this.tilesVisible=8==(8&this.controlByte1),this.spritesVisible=16==(16&this.controlByte1);break;case 2:this.ppuReadBuffer=s,this.openBus=s;break;case 3:this.spriteAddress=255&s,this.openBus=this.spriteAddress;break;case 4:this.spriteRAM[this.spriteAddress]=s,this.spriteAddress=this.spriteAddress+1&255,this.unpackedSprites[this.spriteAddress>>2].Changed=!0,this.spriteChanges=!0;break;case 5:this.addressLatchIsHigh?(this.hScroll=s,this.lockedHScroll=7&this.hScroll,this.addressLatchIsHigh=!1):(this.vScroll=s,s>240&&(this.vScroll=s-256),(!this.frameOn||this.frameOn&&!this.isRendering)&&(this.lockedVScroll=this.vScroll),this.addressLatchIsHigh=!0,this.updatePixelInfo());break;case 6:this.addressLatchIsHigh?(this.address=255&this.address|(63&s)<<8,this.addressLatchIsHigh=!1):(this.address=32512&this.address|255&s,this.addressLatchIsHigh=!0,this.hScroll=(31&this.address)<<3,this.vScroll=(this.address>>5&31)<<3,this.vScroll|=this.address>>12&3,this.frameOn&&(this.lockedHScroll=this.hScroll,this.lockedVScroll=this.vScroll,this.lockedVScroll=this.lockedVScroll-this.currentYPosition),this.nameTableBits=this.address>>10&3,this.nameTableMemoryStart=1024*this.nameTableBits);break;case 7:if(16128==(65280&this.address)){var r=31&this.address;this.palette[r]=s,16128==(65519&this.address)&&(this.palette[31&(16^r)]=s)}else this.memoryMap.setPPUByte(t,this.address,s);4==(4&this.controlByte0)?this.address=this.address+32:this.address=this.address+1,this.addressLatchIsHigh=!0,this.address=16383&this.address}},t.prototype.getByte=function(t,e){switch(7&e){case 3:case 0:case 1:case 5:case 6:return this.openBus;case 2:var s;return this.addressLatchIsHigh=!0,128==(128&(s=31&this.ppuReadBuffer|this.status))&&(this.status=-129&this.status),s;case 4:return this.spriteRAM[this.spriteAddress];case 7:var r=0;return 16128==(65280&this.address)?(r=this.palette[31&this.address],this.ppuReadBuffer=this.memoryMap.getPPUByte(t,this.address-4096)):(r=this.ppuReadBuffer,this.address>=8192&&this.address<=12287?this.ppuReadBuffer=this.memoryMap.getPPUByte(t,this.address):this.ppuReadBuffer=this.memoryMap.getPPUByte(t,16383&this.address)),4==(4&this.controlByte0)?this.address=this.address+32:this.address=this.address+1,this.address=16383&this.address,r}return 0},t.prototype.copySprites=function(t){for(var e=0;e<256;++e){var s=this.spriteAddress+e&255;this.spriteRAM[s]!==this.memoryMap.Rams[t+e]&&(this.spriteRAM[s]=this.memoryMap.Rams[t+e],this.unpackedSprites[s>>2&255].Changed=!0)}this._spriteCopyHasHappened=!0,this.spriteChanges=!0},t.prototype.initSprites=function(){this.currentSprites=new Array(64);for(var t=0;t<64;++t)this.currentSprites[t]=new r.ChiChiSprite;this.unpackedSprites=new Array(64);for(t=0;t<64;++t)this.unpackedSprites[t]=new r.ChiChiSprite},t.prototype.getSpritePixel=function(){this.isForegroundPixel=!1,this.spriteZeroHit=!1;for(var t=0,e=0,s=0,r=0,i=0;i<this.spritesOnThisScanline;++i){var n=this.currentSprites[i];if(n.XPosition>0&&this.currentXPosition>=n.XPosition&&this.currentXPosition<n.XPosition+8){var a=0;8==(8&this.controlByte0)&&(a=4096),s=this.currentXPosition-n.XPosition,e=this.currentYPosition-n.YPosition-1,e&=this.spriteSize-1,r=n.TileIndex,32==(32&this.controlByte0)&&(1==(1&r)?(a=4096,r^=1):a=0);var o,h;if(n.FlipY&&(e=this.spriteSize-e-1),e>=8&&(e+=8),o=this.memoryMap.getPPUByte(0,a+16*r+e),h=this.memoryMap.getPPUByte(0,a+16*r+e+8),0!==(t=255&(n.FlipX?o>>s&1|h>>s<<1&2:o>>7-s&1|h>>7-s<<1&2)))return 0===n.SpriteNumber&&(this.spriteZeroHit=!0),this.isForegroundPixel=n.Foreground,t|n.AttributeByte}}return 0},t.prototype.decodeSpritePixel=function(t,e,s,r,i){var n,a;r.v.FlipY&&(s=this.spriteSize-s-1),s>=8&&(s+=8);var o=t+(i<<4)+s;return n=this.memoryMap.getPPUByte(this.LastcpuClock,o),a=this.memoryMap.getPPUByte(this.LastcpuClock,o+8),r.v.FlipX?n>>e&1|a>>e<<1&2:n>>7-e&1|a>>7-e<<1&2},t.prototype.preloadSprites=function(t){this.spritesOnThisScanline=0;this.currentYPosition;for(var e=0;e<256;e+=4){var s=(e+this.spriteAddress&255)>>2,r=this.unpackedSprites[s].YPosition+1;if(t>=r&&t<r+this.spriteSize&&(this.currentSprites[this.spritesOnThisScanline]=this.unpackedSprites[s],this.currentSprites[this.spritesOnThisScanline].IsVisible=!0,this.spritesOnThisScanline++,64===this.spritesOnThisScanline))break}this.spritesOnThisScanline>7&&(this.status=32|this.status)},t.prototype.unpackSprites=function(){for(var t=0;t<this.unpackedSprites.length;++t)this.unpackedSprites[t].Changed&&this.unpackSprite(t)},t.prototype.unpackSprite=function(t){var e=this.spriteRAM[2+(t<<2)|0];this.unpackedSprites[t].IsVisible=!0,this.unpackedSprites[t].AttributeByte=(3&e)<<2|16,this.unpackedSprites[t].YPosition=this.spriteRAM[4*t],this.unpackedSprites[t].XPosition=this.spriteRAM[4*t+3],this.unpackedSprites[t].SpriteNumber=t,this.unpackedSprites[t].Foreground=32!=(32&e),this.unpackedSprites[t].FlipX=64==(64&e),this.unpackedSprites[t].FlipY=128==(128&e),this.unpackedSprites[t].TileIndex=this.spriteRAM[4*t+1],this.unpackedSprites[t].Changed=!1},t.prototype.getNameTablePixel=function(){var t=(128&this.patternEntry)>>7|(128&this.patternEntryByte2)>>6;return this.patternEntry<<=1,this.patternEntryByte2<<=1,t>0&&(t|=this.currentAttributeByte),255&t},t.prototype.getAttrEntry=function(t,e,s){var r=this.memoryMap.getPPUByte(0,8192+t+960+(e>>2)+8*(s>>2));switch(2&e|2*(2&s)){case 0:return r<<2&12;case 2:return 12&r;case 4:return r>>2&12;case 6:return r>>4&12}return 0},t.prototype.advanceClock=function(t){var e=3*t;if(this.frameClock>89002){if(this.frameClock+=e,!(this.frameClock>89342))return;e=this.frameClock-89342}for(;e--;){switch(this.frameClock){case 0:this.shouldRender=!0,this.pixelBuffer.reset(),this.currentXPosition=0,this.currentYPosition=0,this.xNTXor=0,this.yNTXor=0,0!=(24&this.controlByte1)&&(this.oddFrame=!this.oddFrame,this.isRendering=!0);break;case 81840:this.shouldRender=!1,this.frameFinished(),this.frameOn=!1;break;case 82523:this.setupVINT();break;case 89002:this.status=0,this.hitSprite=!1,this.spriteSize=32==(32&this.controlByte0)?16:8,this.spriteChanges&&(this.unpackSprites(),this.spriteChanges=!1),this.frameOn=!0,this.oddFrame&&this.frameClock++}this.frameOn&&this.renderPixel(this.LastcpuClock+t),this.frameClock++,this.frameClock>=89342&&(this.frameClock=0)}},t.prototype.renderPixel=function(t){if(this.currentXPosition<256&&this.currentYPosition<=240){if(this.xPosition=this.currentXPosition+this.lockedHScroll,0==(7&this.xPosition)){this.xNTXor=256&this.xPosition?1024:0,this.xPosition&=255;var e=this.nameTableMemoryStart^this.xNTXor^this.yNTXor,s=this.xPosition>>3,r=8192+e+s+((this.yPosition>>3)%30<<5),i=this.memoryMap.getPPUByte(t,r),n=7&this.yPosition,a=this.backgroundPatternTableIndex+16*i+n;this.patternEntry=this.memoryMap.getPPUByte(t,a),this.patternEntryByte2=this.memoryMap.getPPUByte(t,a+8),this.currentAttributeByte=this.getAttrEntry(e,s,this.yPosition>>3)}var o=this.tilesVisible,h=this.spritesVisible;this.currentXPosition<8&&(h=(o=o&&!this.clipTiles)&&!this.clipSprites),this.spriteZeroHit=!1;var c=o?this.getNameTablePixel():0,u=h?this.getSpritePixel():0;!this.hitSprite&&this.spriteZeroHit&&0!==c&&(this.hitSprite=!0,this.status=64|this.status);var p=this.palette[this.isForegroundPixel||0===c&&0!==u?u:c];this.pixelBuffer.draw(p)}this.currentXPosition++,this.currentXPosition>340&&(this.currentXPosition=0,this.currentYPosition++,this.preloadSprites(this.currentYPosition),this.spritesOnThisScanline>=7&&(this.status=32|this.status),this.lockedHScroll=this.hScroll,this.memoryMap.advanceScanline(1),this.updatePixelInfo(),this.yPosition=this.currentYPosition+this.lockedVScroll,this.yPosition<0&&(this.yPosition+=240),this.yPosition>=240?(this.yPosition-=240,this.yNTXor=2048):this.yNTXor=0)},t.prototype.updatePixelInfo=function(){this.nameTableMemoryStart=1024*this.nameTableBits},t.prototype.setupStateBuffer=function(t){var e=this;return t.onRestore.subscribe(function(t){e.attachStateBuffer(t)}),t.onUpdateBuffer.subscribe(function(t){e.updateStateBuffer(t)}),t.pushSegment(256*Uint8Array.BYTES_PER_ELEMENT,"spriteram").pushSegment(2,"ppuaddress").pushSegment(2,"spriteaddress").pushSegment(2,"ppucontrolbytes").pushSegment(2,"ppustatus").pushSegment(2,"hvscroll").pushSegment(2,"lockedhvscroll"),t},t.prototype.attachStateBuffer=function(t){this.spriteRAM=t.getUint8Array("spriteram"),this.address=t.getUint16Array("ppuaddress")[0],this.spriteAddress=t.getUint8Array("spriteaddress")[0];var e=t.getUint8Array("ppucontrolbytes");this.controlByte0=e[0],this.controlByte1=e[1],this.status=t.getUint8Array("ppustatus")[0];var s=t.getUint8Array("hvscroll");this.hScroll=s[0],this.vScroll=s[1];var r=t.getUint8Array("lockedhvscroll");this.lockedHScroll=r[0],this.lockedVScroll=r[1],this.nameTableBits=3&this.controlByte0,this.backgroundPatternTableIndex=4096*((16&this.controlByte0)>>4),this.greyScale=1==(1&this.controlByte1),this.emphasisBits=this.controlByte1>>5&7,this.spritesVisible=16==(16&this.controlByte1),this.tilesVisible=8==(8&this.controlByte1),this.clipTiles=2!=(2&this.controlByte1),this.clipSprites=4!=(4&this.controlByte1)},t.prototype.updateStateBuffer=function(t){t.getUint16Array("ppuaddress")[0]=this.address,t.getUint8Array("spriteaddress")[0]=this.spriteAddress;var e=t.getUint8Array("ppucontrolbytes");e[0]=this.controlByte0,e[1]=this.controlByte1,t.getUint8Array("ppustatus")[0]=this.status;var s=t.getUint8Array("hvscroll");s[0]=this.hScroll,s[1]=this.vScroll;var r=t.getUint8Array("lockedhvscroll");r[0]=this.lockedHScroll,r[1]=this.lockedVScroll},t}();e.ChiChiPPU=n;var a=function(t){return void 0===t&&(t=i),function(e){var s=0,r=(new Uint8Array(e),new Uint32Array(e));return{reset:function(){s=0},buffer:e,draw:function(e){r[s++]=4278190080|t[63&e]}}}};e.PixelBuffers={createRawPixelBuffer:function(t){var e=0,s=new Uint8Array(t);return{reset:function(){e=0},buffer:t,draw:function(t){s[4*e]=t,e++}}},createDecodedPixelBuffer:a}},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=[[43,-115,350,-488,1136,-914,5861,21022],[44,-118,348,-473,1076,-799,5274,21001],[45,-121,344,-454,1011,-677,4706,20936],[46,-122,336,-431,942,-549,4156,20829],[47,-123,327,-404,868,-418,3629,20679],[47,-122,316,-375,792,-285,3124,20488],[47,-120,303,-344,714,-151,2644,20256],[46,-117,289,-310,634,-17,2188,19985],[46,-114,273,-275,553,117,1758,19675],[44,-108,255,-237,471,247,1356,19327],[43,-103,237,-199,390,373,981,18944],[42,-98,218,-160,310,495,633,18527],[40,-91,198,-121,231,611,314,18078],[38,-84,178,-81,153,722,22,17599],[36,-76,157,-43,80,824,-241,17092],[34,-68,135,-3,8,919,-476,16558],[32,-61,115,34,-60,1006,-683,16001],[29,-52,94,70,-123,1083,-862,15422],[27,-44,73,106,-184,1152,-1015,14824],[25,-36,53,139,-239,1211,-1142,14210],[22,-27,34,170,-290,1261,-1244,13582],[20,-20,16,199,-335,1301,-1322,12942],[18,-12,-3,226,-375,1331,-1376,12293],[15,-4,-19,250,-410,1351,-1408,11638],[13,3,-35,272,-439,1361,-1419,10979],[11,9,-49,292,-464,1362,-1410,10319],[9,16,-63,309,-483,1354,-1383,9660],[7,22,-75,322,-496,1337,-1339,9005],[6,26,-85,333,-504,1312,-1280,8355],[4,31,-94,341,-507,1278,-1205,7713],[3,35,-102,347,-506,1238,-1119,7082],[1,40,-110,350,-499,1190,-1021,6464],[0,43,-115,350,-488,1136,-914,5861]],a=function(){function t(){this.neswait=!1,this.synced=!0,this.controlBuffer=new Int32Array(new ArrayBuffer(3*Int32Array.BYTES_PER_ELEMENT)),this.sharedAudioBufferPos=0,this.SharedBufferLength=8192,this.chunkSize=1024,this.SharedBuffer=new Float32Array(this.SharedBufferLength)}return Object.defineProperty(t.prototype,"bufferPosition",{get:function(){return this.controlBuffer[2]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"audioBytesWritten",{get:function(){return this.controlBuffer[0]},set:function(t){this.controlBuffer[0]=t},enumerable:!0,configurable:!0}),t.prototype.wakeSleepers=function(){this.neswait=!1},t.prototype.synchronize=function(){this.synced?this.audioBytesWritten>=this.chunkSize&&(this.controlBuffer[2]=this.sharedAudioBufferPos,this.neswait=!0):this.audioBytesWritten=this.chunkSize},t.sample_size=1,t}();e.WavSharer=a;var o=function(t){function e(e){var s=t.call(this)||this;return e.onRestore.subscribe(function(t){s.SharedBuffer=t.getFloat32Array("abuffer")}),s.blip_new(8820),s}return i(e,t),e.prototype.blip_new=function(t){this.blipBuffer=new h(t+18),this.blipBuffer.size=t,this.blipBuffer.factor=0,this.blip_clear()},e.prototype.blip_set_rates=function(t,e){this.blipBuffer.factor=2097152/t*e+.9999847412109375},e.prototype.blip_clear=function(){this.blipBuffer.offset=0,this.blipBuffer.avail=0,this.blipBuffer.integrator=0},e.prototype.blip_end_frame=function(t){var e=t*this.blipBuffer.factor+this.blipBuffer.offset;this.blipBuffer.avail+=e>>21,this.blipBuffer.offset=2097151&e},e.prototype.remove_samples=function(t){var e=this.blipBuffer.avail+18-t;this.blipBuffer.avail-=t,this.blipBuffer.samples.copyWithin(0,t,t+e),this.blipBuffer.samples.fill(0,e,e+t),this.blipBuffer.arrayLength=t},e.prototype.readElementsLoop=function(){var t=this.SharedBuffer,e=this.sharedAudioBufferPos,s=this.blipBuffer.avail,r=0,i=e,n=s,a=this.blipBuffer.integrator,o=1,h=1*o-1;if(o*=1/32768,0!==s){do{var c=a>>15;a+=this.blipBuffer.samples[r],r++,++i>=t.length&&(i=0),t[i]=c*o+h,a-=c<<7}while(n-- >0);this.blipBuffer.integrator=a,this.remove_samples(s)}return this.sharedAudioBufferPos=i,this.audioBytesWritten+=s,this.synchronize(),s},e.prototype.blip_add_delta=function(t,e){if(0!==e){var s=t*this.blipBuffer.factor+this.blipBuffer.offset|0,r=this.blipBuffer.avail+(s>>21),i=(s>>16&31)>>>0,a=i,o=32-i,h=e*(s>>1&32767)>>15;e-=h;for(var c=0;c<8;++c)this.blipBuffer.samples[r+c]+=n[a][c]*e+n[a][c]*h,this.blipBuffer.samples[r+(15-c)]+=n[o][c]*e+n[o-1][c]*h}},e}(a);e.ChiChiWavSharer=o;var h=function(){return function(t){this.size=t,this.factor=0,this.offset=0,this.avail=0,this.integrator=0,this.time_bits=0,this.arrayLength=0,this.samples=new Array(t),this.samples.fill(0)}}()},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(4),i=0,n=1,a=[7,6,0,0,3,2,5,0,3,2,2,0,6,4,6,0,2,5,0,0,3,3,6,0,2,4,2,0,6,4,7,0,6,6,0,0,3,2,5,0,3,2,2,0,4,4,6,0,2,5,0,0,3,3,6,0,2,4,2,0,6,4,7,0,6,6,0,0,3,2,5,0,3,2,2,0,3,4,6,0,2,5,0,0,0,3,6,0,2,4,2,0,6,4,6,0,6,6,0,0,3,3,5,0,3,2,2,0,5,4,6,0,2,5,0,0,0,4,6,0,2,4,2,0,6,4,7,0,3,6,3,0,3,3,3,0,2,3,2,0,4,4,4,0,2,6,0,0,4,4,4,0,2,5,2,0,0,5,0,0,2,6,2,0,3,3,3,0,2,2,2,0,4,4,4,0,2,5,0,0,4,4,4,0,2,4,2,0,4,4,4,0,2,6,3,0,3,2,5,0,2,2,2,0,4,4,6,0,2,5,0,0,3,4,6,0,2,4,2,0,6,4,7,0,2,6,3,0,3,3,5,0,2,2,2,0,4,4,6,0,2,5,0,0,3,4,6,0,2,4,2,0,6,4,7,0],o=[1,12,1,0,0,4,4,0,1,3,2,3,8,8,8,1,7,13,14,1,4,5,5,1,1,10,1,1,8,9,9,1,8,12,1,1,4,4,4,1,1,3,2,3,8,8,8,1,7,13,14,1,5,5,5,1,1,10,1,1,9,9,9,1,1,12,1,1,1,4,4,1,1,3,2,3,8,8,8,1,7,13,14,1,1,5,5,1,1,10,1,1,1,9,9,1,1,12,1,1,4,4,4,1,1,3,2,3,11,8,8,1,7,13,14,1,5,5,5,1,1,10,1,1,15,9,9,1,7,12,3,1,4,4,4,1,1,3,1,1,8,8,8,1,7,13,14,1,5,5,6,1,1,10,1,1,8,9,9,1,3,12,3,1,4,4,4,1,1,3,1,3,8,8,8,1,7,13,14,1,5,5,6,1,1,10,1,1,9,9,10,1,3,12,3,1,4,4,4,1,1,3,1,3,8,8,8,1,7,13,14,1,1,5,5,1,1,10,1,1,1,9,9,1,3,12,3,1,4,4,4,1,1,3,1,3,8,8,8,1,7,13,14,1,1,5,5,1,1,10,1,1,1,9,9,1],h=function(){function t(t,e){var s=this;this.clock=0,this.borrowedCycles=0,this.cpuStatus16=new Uint16Array(2),this.programCounter=0,this.addressBus=0,this.handleNMI=!1,this.cpuStatus=new Uint8Array(8),this.stackPointer=255,this.statusRegister=0,this.accumulator=0,this.indexRegisterX=0,this.indexRegisterY=0,this.dataBus=0,this._operationCounter=0,this._currentInstruction_AddressingMode=r.ChiChiCPPU_AddressingModes.Bullshit,this._currentInstruction_Address=0,this._currentInstruction_OpCode=0,this._currentInstruction_Parameters0=0,this._currentInstruction_Parameters1=0,this._currentInstruction_ExtraTiming=0,this.systemClock=0,this.instructionUsage=new Uint32Array(256),this.debugging=!1,this.cheating=!1,this.genieCodes=new Array,this.instructionHistoryPointer=255,this._instructionHistory=new Array(256),this.setupStateBuffer=function(t){return function(t,e){return e.onRestore.subscribe(function(e){c(t,e)}),e.onUpdateBuffer.subscribe(function(e){u(t,e)}),e.pushSegment(2*Uint16Array.BYTES_PER_ELEMENT,"cpu_status_16").pushSegment(8,"cpu_status"),e}(s,t)},this.SoundBopper=t,this.ppu=e;for(var i=0;i<this._instructionHistory.length;++i)this._instructionHistory[i]=new r.ChiChiInstruction}return t.prototype.advanceClock=function(t){t&&(this.memoryMap.advanceClock(t),this.clock+=t)},t.prototype.cheat=function(t,e){var s=this.genieCodes.find(function(e){return e.address==t});if(!s)return e;s.data>255?s.data>>8==e&&(e=255&s.data):e=s.data;return e},Object.defineProperty(t.prototype,"InstructionHistory",{get:function(){return this._instructionHistory},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"InstructionHistoryPointer",{get:function(){return this.instructionHistoryPointer},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Clock",{get:function(){return this.clock},set:function(t){this.advanceClock(t),this.clock=t},enumerable:!0,configurable:!0}),t.prototype.setFlag=function(t,e){this.statusRegister=e?this.statusRegister|t:this.statusRegister&~t,this.statusRegister|=32},t.prototype.GetFlag=function(t){return(this.statusRegister&t)===t},t.prototype.interruptRequest=function(){if(!this.GetFlag(4)){this.advanceClock(7),this.setFlag(4,!0);this.statusRegister;this.pushStack(this.programCounter>>8),this.pushStack(this.programCounter),this.pushStack(this.statusRegister),this.programCounter=this.getByte(65534)+(this.getByte(65535)<<8)}},t.prototype.nonMaskableInterrupt=function(){var t=-17&this.statusRegister|32;this.setFlag(4,!0),this.pushStack(this.programCounter>>8),this.pushStack(255&this.programCounter),this.pushStack(t);var e=this.getByte(65530)|this.getByte(65531)<<8;this.programCounter=e},t.prototype.step=function(){this._currentInstruction_ExtraTiming=0,this.handleNMI?(this.advanceClock(7),this.handleNMI=!1,this.nonMaskableInterrupt()):this.memoryMap.irqRaised()&&this.interruptRequest(),this._currentInstruction_Address=this.programCounter,this._currentInstruction_OpCode=this.getByte(this.programCounter),this.programCounter=this.programCounter+1&65535,this._currentInstruction_AddressingMode=o[this._currentInstruction_OpCode],this.fetchInstructionParameters(),this.execute(),this.advanceClock(a[this._currentInstruction_OpCode]),this.advanceClock(this._currentInstruction_ExtraTiming),this.borrowedCycles&&(this.advanceClock(this.borrowedCycles),this.borrowedCycles=0)},t.prototype.fetchInstructionParameters=function(){switch(this._currentInstruction_AddressingMode){case r.ChiChiCPPU_AddressingModes.Absolute:case r.ChiChiCPPU_AddressingModes.AbsoluteX:case r.ChiChiCPPU_AddressingModes.AbsoluteY:case r.ChiChiCPPU_AddressingModes.Indirect:this._currentInstruction_Parameters0=this.getByte(65535&this.programCounter++),this._currentInstruction_Parameters1=this.getByte(65535&this.programCounter++);break;case r.ChiChiCPPU_AddressingModes.ZeroPage:case r.ChiChiCPPU_AddressingModes.ZeroPageX:case r.ChiChiCPPU_AddressingModes.ZeroPageY:case r.ChiChiCPPU_AddressingModes.Relative:case r.ChiChiCPPU_AddressingModes.IndexedIndirect:case r.ChiChiCPPU_AddressingModes.IndirectIndexed:case r.ChiChiCPPU_AddressingModes.IndirectZeroPage:case r.ChiChiCPPU_AddressingModes.Immediate:this._currentInstruction_Parameters0=this.getByte(65535&this.programCounter++);break;case r.ChiChiCPPU_AddressingModes.Accumulator:case r.ChiChiCPPU_AddressingModes.Implicit:}},t.prototype.ResetCPU=function(){this.statusRegister=52,this._operationCounter=0,this.stackPointer=253,this.programCounter=this.getByte(65532)|this.getByte(65533)<<8,this.advanceClock(4),this.genieCodes=[]},t.prototype.PowerOn=function(){this.statusRegister=52,this.stackPointer=253,this._operationCounter=0,this.advanceClock(4),this.programCounter=this.getByte(65532)|this.getByte(65533)<<8},t.prototype.decodeAddress=function(){this._currentInstruction_ExtraTiming=0;var t=0,e=0,s=0;switch(this._currentInstruction_AddressingMode){case r.ChiChiCPPU_AddressingModes.Absolute:t=this._currentInstruction_Parameters1<<8|this._currentInstruction_Parameters0;break;case r.ChiChiCPPU_AddressingModes.AbsoluteX:(255&(t=(this._currentInstruction_Parameters1<<8|this._currentInstruction_Parameters0)+this.indexRegisterX|0))<this.indexRegisterX&&(this._currentInstruction_ExtraTiming=1);break;case r.ChiChiCPPU_AddressingModes.AbsoluteY:(255&(t=(this._currentInstruction_Parameters1<<8|this._currentInstruction_Parameters0)+this.indexRegisterY|0))<this.indexRegisterY&&(this._currentInstruction_ExtraTiming=1);break;case r.ChiChiCPPU_AddressingModes.ZeroPage:t=this._currentInstruction_Parameters0;break;case r.ChiChiCPPU_AddressingModes.ZeroPageX:t=255&(this._currentInstruction_Parameters0+this.indexRegisterX|0);break;case r.ChiChiCPPU_AddressingModes.ZeroPageY:t=255&((255&this._currentInstruction_Parameters0)+(255&this.indexRegisterY)|0);break;case r.ChiChiCPPU_AddressingModes.Indirect:e=this._currentInstruction_Parameters0;var i=65535&((s=this._currentInstruction_Parameters1<<8)|e),n=this.getByte(i);i=65535&(s|(e=255&(e+1|0))),t=n|=this.getByte(i)<<8;break;case r.ChiChiCPPU_AddressingModes.IndexedIndirect:var a=255&(this._currentInstruction_Parameters0+this.indexRegisterX|0);e=this.getByte(a),a=a+1|0,s=this.getByte(255&a),t=(s<<=8)|e;break;case r.ChiChiCPPU_AddressingModes.IndirectIndexed:(255&(t=(a=(e=this.getByte(this._currentInstruction_Parameters0))|(s=this.getByte(255&(this._currentInstruction_Parameters0+1|0))<<8))+this.indexRegisterY|0))>this.indexRegisterY&&(this._currentInstruction_ExtraTiming=1);break;case r.ChiChiCPPU_AddressingModes.Relative:t=this.programCounter+this._currentInstruction_Parameters0|0;break;default:this.handleBadOperation()}return 65535&t},t.prototype.handleBadOperation=function(){},t.prototype.handleBreakpoint=function(){},t.prototype.decodeOperand=function(){switch(this._currentInstruction_AddressingMode){case r.ChiChiCPPU_AddressingModes.Immediate:return this.dataBus=this._currentInstruction_Parameters0,this._currentInstruction_Parameters0;case r.ChiChiCPPU_AddressingModes.Accumulator:return this.accumulator;default:return this.dataBus=this.getByte(this.decodeAddress()),this.dataBus}},t.prototype.execute=function(){var t=0,e=0,s=0,i=0,n=0,a=0;switch(this._currentInstruction_OpCode){case 128:case 130:case 194:case 226:case 4:case 20:case 52:case 68:case 84:case 100:case 116:case 212:case 244:case 12:case 28:case 60:case 92:case 124:case 220:case 252:this.decodeAddress();break;case 105:case 101:case 117:case 109:case 125:case 121:case 97:case 113:t=this.decodeOperand(),i=1&this.statusRegister,n=this.accumulator+t+i|0,this.setFlag(1,n>255),this.setFlag(64,128!=(128&(this.accumulator^t))&&128==(128&(this.accumulator^n))),this.accumulator=255&n,this.setZNFlags(this.accumulator);break;case 41:case 37:case 53:case 45:case 61:case 57:case 33:case 49:this.accumulator=this.accumulator&this.decodeOperand(),this.setZNFlags(this.accumulator);break;case 10:case 6:case 22:case 14:case 30:t=this.decodeOperand(),this.setFlag(1,128==(128&t)),t=t<<1&254,this._currentInstruction_AddressingMode===r.ChiChiCPPU_AddressingModes.Accumulator?this.accumulator=t:this.setByte(this.decodeAddress(),t),this.setZNFlags(t);break;case 144:1!=(1&this.statusRegister)&&this.branch();break;case 176:1==(1&this.statusRegister)&&this.branch();break;case 240:2==(2&this.statusRegister)&&this.branch();break;case 36:case 44:t=this.decodeOperand(),this.setFlag(64,64==(64&t)),this.statusRegister=128==(128&t)?128|this.statusRegister:127&this.statusRegister,0==(t&this.accumulator)?this.statusRegister=2|this.statusRegister:this.statusRegister=253&this.statusRegister;break;case 48:128==(128&this.statusRegister)&&this.branch();break;case 208:2!=(2&this.statusRegister)&&this.branch();break;case 16:128!=(128&this.statusRegister)&&this.branch();break;case 0:this.programCounter=this.programCounter+1,this.pushStack(this.programCounter>>8&255),this.pushStack(255&this.programCounter),t=48|this.statusRegister,this.pushStack(t),this.statusRegister=20|this.statusRegister,this.addressBus=65534,e=this.getByte(this.addressBus),this.addressBus=65535,s=this.getByte(this.addressBus),this.programCounter=e+256*s;break;case 80:64!=(64&this.statusRegister)&&this.branch();break;case 112:64==(64&this.statusRegister)&&this.branch();break;case 24:this.setFlag(1,!1);break;case 216:this.setFlag(8,!1);break;case 88:this.setFlag(4,!1);break;case 184:this.setFlag(64,!1);break;case 201:case 197:case 213:case 205:case 221:case 217:case 193:case 209:t=this.accumulator+256-this.decodeOperand(),this.compare(t);break;case 224:case 228:case 236:t=this.indexRegisterX+256-this.decodeOperand(),this.compare(t);break;case 192:case 196:case 204:t=this.indexRegisterY+256-this.decodeOperand(),this.compare(t);break;case 198:case 214:case 206:case 222:t=(t=this.decodeOperand())-1&255,this.setByte(this.decodeAddress(),t),this.setZNFlags(t);break;case 202:this.indexRegisterX=this.indexRegisterX-1,this.indexRegisterX=255&this.indexRegisterX,this.setZNFlags(this.indexRegisterX);break;case 136:this.indexRegisterY=this.indexRegisterY-1,this.indexRegisterY=255&this.indexRegisterY,this.setZNFlags(this.indexRegisterY);break;case 73:case 69:case 85:case 77:case 93:case 89:case 65:case 81:this.accumulator=this.accumulator^this.decodeOperand(),this.setZNFlags(this.accumulator);break;case 230:case 246:case 238:case 254:t=(t=this.decodeOperand())+1&255,this.setByte(this.decodeAddress(),t),this.setZNFlags(t);break;case 232:this.indexRegisterX=this.indexRegisterX+1,this.indexRegisterX=255&this.indexRegisterX,this.setZNFlags(this.indexRegisterX);break;case 200:this.indexRegisterY=this.indexRegisterY+1,this.indexRegisterY=255&this.indexRegisterY,this.setZNFlags(this.indexRegisterY);break;case 76:case 108:this._currentInstruction_AddressingMode===r.ChiChiCPPU_AddressingModes.Indirect&&255===this._currentInstruction_Parameters0?this.programCounter=255|this._currentInstruction_Parameters1<<8:this.programCounter=this.decodeAddress();break;case 32:this.pushStack(this.programCounter>>8&255),this.pushStack(this.programCounter-1&255),this.programCounter=this.decodeAddress();break;case 169:case 165:case 181:case 173:case 189:case 185:case 161:case 177:this.accumulator=this.decodeOperand(),this.setZNFlags(this.accumulator);break;case 162:case 166:case 182:case 174:case 190:this.indexRegisterX=this.decodeOperand(),this.setZNFlags(this.indexRegisterX);break;case 160:case 164:case 180:case 172:case 188:this.indexRegisterY=this.decodeOperand(),this.setZNFlags(this.indexRegisterY);break;case 74:case 70:case 86:case 78:case 94:t=this.decodeOperand(),this.setFlag(1,1==(1&t)),t=t>>1&255,this.setZNFlags(t),this._currentInstruction_AddressingMode===r.ChiChiCPPU_AddressingModes.Accumulator?this.accumulator=t:this.setByte(this.decodeAddress(),t);break;case 234:case 26:case 58:case 90:case 122:case 218:case 250:case 137:this.decodeAddress();break;case 9:case 5:case 21:case 13:case 29:case 25:case 1:case 17:this.accumulator=this.accumulator|this.decodeOperand(),this.setZNFlags(this.accumulator);break;case 72:this.pushStack(this.accumulator);break;case 8:t=48|this.statusRegister,this.pushStack(t);break;case 104:this.accumulator=this.popStack(),this.setZNFlags(this.accumulator);break;case 40:this.statusRegister=this.popStack();break;case 42:case 38:case 54:case 46:case 62:t=this.decodeOperand(),a=1==(1&this.statusRegister)?1:0,this.setFlag(1,128==(128&t)),t=255&(t<<1|a),this.setZNFlags(t),this._currentInstruction_AddressingMode===r.ChiChiCPPU_AddressingModes.Accumulator?this.accumulator=t:this.setByte(this.decodeAddress(),t);break;case 106:case 102:case 118:case 110:case 126:t=this.decodeOperand(),a=1==(1&this.statusRegister)?128:0,this.setFlag(1,1==(1&t)),t=t>>1|a,this.setZNFlags(t),this._currentInstruction_AddressingMode===r.ChiChiCPPU_AddressingModes.Accumulator?this.accumulator=t:this.setByte(this.decodeAddress(),t);break;case 64:this.statusRegister=this.popStack(),e=this.popStack(),s=this.popStack(),this.programCounter=s<<8|e;break;case 96:e=this.popStack()+1&255,s=this.popStack(),this.programCounter=s<<8|e;break;case 235:case 233:case 229:case 245:case 237:case 253:case 249:case 225:case 241:t=4095&this.decodeOperand(),i=1&(1^this.statusRegister),n=(this.accumulator-t&4095)-i&4095,this.setFlag(64,128==(128&(this.accumulator^n))&&128==(128&(this.accumulator^t))),this.setFlag(1,n<256),this.accumulator=255&n,this.setZNFlags(this.accumulator);break;case 56:this.setFlag(1,!0);break;case 248:this.setFlag(8,!0);break;case 120:this.setFlag(4,!0);break;case 133:case 149:case 141:case 157:case 153:case 129:case 145:this.setByte(this.decodeAddress(),this.accumulator);break;case 134:case 150:case 142:this.setByte(this.decodeAddress(),this.indexRegisterX);break;case 132:case 148:case 140:this.setByte(this.decodeAddress(),this.indexRegisterY);break;case 170:this.indexRegisterX=this.accumulator,this.setZNFlags(this.indexRegisterX);break;case 168:this.indexRegisterY=this.accumulator,this.setZNFlags(this.indexRegisterY);break;case 186:this.indexRegisterX=this.stackPointer,this.setZNFlags(this.indexRegisterX);break;case 138:this.accumulator=this.indexRegisterX,this.setZNFlags(this.accumulator);break;case 154:this.stackPointer=this.indexRegisterX;break;case 152:this.accumulator=this.indexRegisterY,this.setZNFlags(this.accumulator);break;case 11:case 43:this.accumulator=this.decodeOperand()&this.accumulator&255,this.setFlag(1,128==(128&this.accumulator)),this.setZNFlags(this.accumulator);break;case 75:this.accumulator=this.decodeOperand()&this.accumulator,this.setFlag(1,1==(1&this.accumulator)),this.accumulator=this.accumulator>>1,this.setZNFlags(this.accumulator);break;case 107:switch(this.accumulator=this.decodeOperand()&this.accumulator,1==(1&this.statusRegister)?this.accumulator=this.accumulator>>1|128:this.accumulator=this.accumulator>>1,this.setFlag(1,1==(1&this.accumulator)),48&this.accumulator){case 48:this.setFlag(1,!0),this.setFlag(4,!1);break;case 0:this.setFlag(1,!1),this.setFlag(4,!1);break;case 16:this.setFlag(1,!1),this.setFlag(4,!0);break;case 32:this.setFlag(1,!0),this.setFlag(4,!0)}break;case 171:this.indexRegisterX=this.accumulator=this.decodeOperand()&this.accumulator,this.setZNFlags(this.indexRegisterX)}},t.prototype.setZNFlags=function(t){0==(255&t)?this.statusRegister|=2:this.statusRegister&=-3,128==(128&t)?this.statusRegister|=128:this.statusRegister&=-129},t.prototype.compare=function(t){this.setFlag(1,t>255),this.setZNFlags(255&t)},t.prototype.branch=function(){var t=this.programCounter>>8&255;this._currentInstruction_ExtraTiming=1;var e=255&this._currentInstruction_Parameters0;128==(128&e)&&(e-=256),this.programCounter+=e,this.programCounter&=65535,t!=(this.programCounter>>8&255)&&(this._currentInstruction_ExtraTiming=2)},t.prototype.nmiHandler=function(){this.handleNMI=!0},t.prototype.pushStack=function(t){this.memoryMap.Rams[this.stackPointer+256]=t,this.stackPointer--,this.stackPointer<0&&(this.stackPointer=255)},t.prototype.popStack=function(){return this.stackPointer++,this.stackPointer>255&&(this.stackPointer=0),this.memoryMap.Rams[this.stackPointer+256]},t.prototype.getByte=function(t){if(!this.memoryMap)return 0;var e=this.memoryMap.getByte(this.clock,t);if(this.cheating){var s=this.genieCodes.find(function(e){return e.address==t});if(s&&s.active&&s.address==t)return s.compare>-1?255&(s.compare==e?s.data:e):s.data}return 255&e},t.prototype.setByte=function(t,e){this.memoryMap&&this.memoryMap.setByte(this.clock,t,e)},t.prototype.HandleNextEvent=function(){},t.prototype.ResetInstructionHistory=function(){this.instructionHistoryPointer=255},t}();function c(t,e){t.cpuStatus=e.getUint8Array("cpu_status"),t.cpuStatus16=e.getUint16Array("cpu_status_16")}function u(t,e){t.cpuStatus16[i]=t.programCounter,t.cpuStatus16[n]=t.addressBus,t.cpuStatus[0]=t.statusRegister,t.cpuStatus[1]=t.accumulator,t.cpuStatus[2]=t.indexRegisterX,t.cpuStatus[3]=t.indexRegisterY,t.cpuStatus[4]=t.dataBus,t.cpuStatus[5]=t.stackPointer}e.ChiChiCPPU=h,e.stateConfig=function(t){return function(e){return{configure:function(){e.pushSegment(2*Uint16Array.BYTES_PER_ELEMENT,"cpu_status_16").pushSegment(8,"cpu_status")},push:function(){return u(t)},pull:function(){return c(t,e)}}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(18);e.bufferType="ArrayBuffer";var i=function(){function t(){this.data={buffer:void 0,segments:new Array},this.bufferSize=0,this.onRestore=new r.Subject,this.onUpdateBuffer=new r.Subject}return t.prototype.pushArray=function(t,e){return this.pushSegment(t.length*t.BYTES_PER_ELEMENT,e),this},t.prototype.pushSegment=function(t,e){if(-1===this.data.segments.findIndex(function(t,s){return t.name==e})){var s=this.bufferSize;this.data.segments.push({name:e,start:s,size:t}),this.bufferSize+=t}return this},t.prototype.build=function(){return this.data.buffer=new ArrayBuffer(this.bufferSize),this.onRestore.next(this),this},t.prototype.updateBuffer=function(){this.onUpdateBuffer.next(this)},t.prototype.getSegment=function(t){var e=this.data.segments.find(function(e){return e.name===t});return{buffer:this.data.buffer,start:e.start,size:e.size}},t.prototype.getUint8Array=function(t){var e=this.data.segments.find(function(e){return e.name===t});return new Uint8Array(this.data.buffer,e.start,e.size)},t.prototype.getUint16Array=function(t){var e=this.data.segments.find(function(e){return e.name===t});return new Uint16Array(this.data.buffer,e.start,e.size/Uint16Array.BYTES_PER_ELEMENT)},t.prototype.getUint32Array=function(t){var e=this.data.segments.find(function(e){return e.name===t});return new Uint32Array(this.data.buffer,e.start,e.size/Uint32Array.BYTES_PER_ELEMENT)},t.prototype.getFloat32Array=function(t){var e=this.data.segments.find(function(e){return e.name===t});return new Float32Array(this.data.buffer,e.start,e.size/Float32Array.BYTES_PER_ELEMENT)},t.prototype.syncBuffer=function(t){this.data=t,this.onRestore.next(this)},t}();e.StateBuffer=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){return function(){var t=this;this.currentByte=0,this.readNumber=0,this.getPadState=function(){return 0},this.getByte=function(e,s){var r=t.currentByte>>t.readNumber&1;return t.readNumber=t.readNumber+1&7,255&(64|r)},this.setByte=function(e,s,r){1==(1&r)&&(t.currentByte=t.getPadState(),16==(16&t.currentByte)&&(t.currentByte=-33&t.currentByte),64==(64&t.currentByte)&&(t.currentByte=-129&t.currentByte),t.readNumber=0)}}}();e.ChiChiControlPad=r},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.irqLatch=0,e.prescaler=341,e.irqCounter=0,e.irqMode=!1,e.irqEnableAfterAck=!1,e.irqEnable=!1,e}return i(e,t),e.prototype.tickIrq=function(){this.irqCounter>=255?(this.irqCounter=this.irqLatch,this.irqRaised=!0):this.irqCounter++},e.prototype.tick=function(t){if(this.irqMode)for(var e=0;e<t;++e)this.tickIrq();else this.prescaler-=3*t,this.prescaler<=0&&(this.tickIrq(),this.prescaler+=341)},e.prototype.advanceClock=function(t){this.irqEnable&&this.tick(t)},e.prototype.ackIrq=function(){this.irqRaised=!1,this.irqEnable=this.irqEnableAfterAck},Object.defineProperty(e.prototype,"irqControl",{set:function(t){this.irqEnableAfterAck=1==(1&t);var e=2==(2&t);this.irqMode=4==(4&t),this.irqEnable=e},enumerable:!0,configurable:!0}),e}(s(0).BaseCart);e.VRCIrqBase=n;var a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.microwire=!1,e.vrc2=!1,e.swapMode=!1,e.microwireLatch=0,e.latches=[0,0,0,0,0,0,0,0],e.regNums=[0,1,2,3],e.regMask=15,e.ramMask=4095,e.vrc2mirroring=function(t,s,r){if(s<=36867)switch(1&r){case 0:e.mirror(t,1);break;case 1:e.mirror(t,2)}},e.vrc4mirroring=function(t,s,r){if(s<=36865)switch(7&r){case 0:e.mirror(t,1);break;case 1:e.mirror(t,2);break;case 2:e.oneScreenOffset=0,e.mirror(t,0);break;case 3:e.oneScreenOffset=1024,e.mirror(t,0)}36866!=s&&36867!=s||(e.swapMode=2==(2&r))},e.vrcmirroring=e.vrc4mirroring,e}return i(e,t),e.prototype.useMicrowire=function(){this.getByte=this.getByteMicrowire,this.microwire=!0},e.prototype.getByteMicrowire=function(t,e){return e>=24576&&e<=32767?e>>8|this.microwireLatch:this.peekByte(e)},e.prototype.setByteVRC4=function(t,e,s){switch(61440&e){case 24576:this.prgRomBank6[s&this.ramMask]=s;break;case 28672:break;case 32768:var r=31&s;this.swapMode?this.setupBankStarts(2*this.prgRomCount-2,this.currentA,r,this.currentE):this.setupBankStarts(r,this.currentA,2*this.prgRomCount-2,this.currentE);break;case 36864:this.vrc4mirroring(t,e,s);break;case 40960:var i=31&s;this.setupBankStarts(this.current8,i,this.currentC,this.currentE);break;case 45056:case 49152:case 53248:case 57344:var n=e&this.regMask,a=(e>>12&15)-11<<1;n==this.regNums[0]?(this.latches[a]=496&this.latches[a]|15&s,this.copyBanks1k(t,a,this.latches[a],1)):n==this.regNums[1]?(this.latches[a]=15&this.latches[a]|s<<4&496,this.copyBanks1k(t,a,this.latches[a],1)):n==this.regNums[2]?(this.latches[a+1]=496&this.latches[a+1]|15&s,this.copyBanks1k(t,a+1,this.latches[a+1],1)):n==this.regNums[3]&&(this.latches[a+1]=15&this.latches[a+1]|s<<4&496,this.copyBanks1k(t,a+1,this.latches[a+1],1));break;case 61440:switch(3&e){case 0:this.irqLatch=240&this.irqLatch|15&s;break;case 1:this.irqLatch=15&this.irqLatch|s<<4&240;break;case 2:this.irqControl=s;break;case 3:this.ackIrq()}}},e.prototype.setByteVRC2=function(t,e,s){switch(61440&e){case 24576:case 28672:this.microwireLatch=1&s;break;case 32768:var r=31&s;this.swapMode?this.setupBankStarts(2*this.prgRomCount-2,this.currentA,r,this.currentE):this.setupBankStarts(r,this.currentA,2*this.prgRomCount-2,this.currentE);break;case 36864:this.vrc2mirroring(t,e,s);break;case 40960:var i=31&s;this.setupBankStarts(this.current8,i,this.currentC,this.currentE);break;case 45056:case 49152:case 53248:case 57344:var n=e&this.regMask,a=(e>>12&15)-11<<1;n==this.regNums[0]?(this.latches[a]=240&this.latches[a]|15&s,this.copyBanks1k(t,a,this.latches[a],1)):n==this.regNums[1]?(this.latches[a]=15&this.latches[a]|s<<4&240,this.copyBanks1k(t,a,this.latches[a],1)):n==this.regNums[2]?(this.latches[a+1]=240&this.latches[a+1]|15&s,this.copyBanks1k(t,a+1,this.latches[a+1],1)):n==this.regNums[3]&&(this.latches[a+1]=15&this.latches[a+1]|s<<4&240,this.copyBanks1k(t,a+1,this.latches[a+1],1));break;case 61440:0==(3&e)?this.irqLatch=240&this.irqLatch|15&s:1==(3&e)?this.irqLatch=15&this.irqLatch|s<<4&240:2==(3&e)?this.irqControl=s:3==(3&e)&&this.ackIrq()}},e.prototype.setByteVRC2a=function(t,e,s){switch(61440&e){case 24576:case 28672:this.microwire?this.microwireLatch=1&s:this.prgRomBank6[s&this.ramMask]=s;break;case 32768:var r=31&s;this.swapMode?this.setupBankStarts(2*this.prgRomCount-2,this.currentA,r,this.currentE):this.setupBankStarts(r,this.currentA,2*this.prgRomCount-2,this.currentE);break;case 36864:this.vrc2mirroring(t,e,s);break;case 40960:var i=31&s;this.setupBankStarts(this.current8,i,this.currentC,this.currentE);break;case 45056:case 49152:case 53248:case 57344:var n=e&this.regMask,a=(e>>12&15)-11<<1;n==this.regNums[0]?(this.latches[a]=240&this.latches[a]|15&s,this.copyBanks1k(t,a,this.latches[a]>>1,1)):n==this.regNums[1]?(this.latches[a]=15&this.latches[a]|s<<4&240,this.copyBanks1k(t,a,this.latches[a]>>1,1)):n==this.regNums[2]?(this.latches[a+1]=240&this.latches[a+1]|15&s,this.copyBanks1k(t,a+1,this.latches[a+1]>>1,1)):n==this.regNums[3]&&(this.latches[a+1]=15&this.latches[a+1]|s<<4&240,this.copyBanks1k(t,a+1,this.latches[a+1]>>1,1));break;case 61440:0==(3&e)?this.irqLatch=240&this.irqLatch|15&s:1==(3&e)?this.irqLatch=15&this.irqLatch|s<<4&240:2==(3&e)?this.irqControl=s:3==(3&e)&&this.ackIrq()}},e}(n);e.VRC2or4Cart=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.altRegNums=function(){this.regNums=[0,4,8,12],this.regMask=15},e.prototype.initializeCart=function(){switch(this.mapperName="KonamiVRC24",this.usesSRAM=!0,this.ramMask=4095,this.setupBankStarts(0,0,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,0,2),this.setByte=this.setByteVRC4,this.ROMHashFunction){case"CC9FFEC":case"B27B8CF4":this.setByte=this.setByteVRC2,this.useMicrowire();break;case"D467C0CC":case"C1FBF659":case"91328C1D":case"FCBF28B1":this.altRegNums()}},e}(a);e.KonamiVRC2Cart=o;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){switch(this.mapperName="KonamiVRC2a",this.setupBankStarts(0,0,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,0,2),this.regNums=[0,2,1,3],this.vrcmirroring=this.vrc2mirroring,this.useMicrowire(),this.setByte=this.setByteVRC2a,this.ROMHashFunction){case"D4645E14":this.vrcmirroring=this.vrc4mirroring}},e}(a);e.KonamiVRC022Cart=h;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){switch(this.mapperName="KonamiVRC2",this.setupBankStarts(0,0,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,0,2),this.regNums=[0,2,4,6],this.regMask=240,this.ROMHashFunction){case"286FCD20":this.regNums=[0,64,128,192],this.regMask=240,this.ramMask=8191}this.setByte=this.setByteVRC2},e}(a);e.Konami021Cart=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){switch(this.usesSRAM=!0,this.mapperName="KonamiVRC4",this.setupBankStarts(0,0,2*this.prgRomCount-2,2*this.prgRomCount-1),this.regNums=[0,2,1,3],this.regMask=15,this.ROMHashFunction){case"4A601A2C":this.regNums=[0,8,4,12]}this.setByte=this.setByteVRC4},e}(a);e.Konami025Cart=u},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(13);e.ChiChiMachine=r.ChiChiMachine;var i=s(8);e.ChiChiCPPU=i.ChiChiCPPU;var n=s(5);e.ChiChiAPU=n.ChiChiAPU;var a=s(6);e.PixelBuffers=a.PixelBuffers,e.ChiChiPPU=a.ChiChiPPU;var o=s(0);e.BaseCart=o.BaseCart;var h=s(10);e.ChiChiControlPad=h.ChiChiControlPad;var c=s(7);e.WavSharer=c.WavSharer;var u=s(4);e.RunningStatuses=u.RunningStatuses,e.DebugStepTypes=u.DebugStepTypes,e.ChiChiCPPU_AddressingModes=u.ChiChiCPPU_AddressingModes,e.CpuStatus=u.CpuStatus,e.PpuStatus=u.PpuStatus,e.ChiChiInstruction=u.ChiChiInstruction,e.ChiChiSprite=u.ChiChiSprite;var p=s(20);e.ChiChiCheats=p.ChiChiCheats;var f=s(21);e.DebugHelpers=f.DebugHelpers;var l=s(9);e.StateBuffer=l.StateBuffer;var d=s(22);e.iNESFileHandler=d.iNESFileHandler},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(5),i=s(4),n=s(6),a=s(7),o=s(8),h=s(9),c=s(19),u=s(10),p=function(){function t(t){var e=this;this.frameJustEnded=!0,this.frameOn=!1,this.totalCPUClocks=0,this._enableSound=!1,this.evenFrame=!0,this.sb=new h.StateBuffer;var s=new a.ChiChiWavSharer(this.sb);this.SoundBopper=new r.ChiChiAPU(s),this.WaveForms=s,this.ppu=new n.ChiChiPPU,this.Cpu=t||new o.ChiChiCPPU(this.SoundBopper,this.ppu),this.ppu.cpu=this.Cpu,this.ppu.NMIHandler=function(){e.Cpu.nmiHandler()},this.ppu.frameFinished=function(){e.frameFinished()},this.controllerPortOne=new u.ChiChiControlPad,this.controllerPortTwo=new u.ChiChiControlPad,this.mapFactory=c.setupMemoryMap(this.Cpu)(this.ppu)(this.SoundBopper)(this.controllerPortOne)(this.controllerPortTwo)}return t.prototype.loadCart=function(t){this.mapFactory(t),this.RebuildStateBuffer(),t.installCart(this.ppu,this.Cpu)},Object.defineProperty(t.prototype,"StateBuffer",{get:function(){return this.sb},enumerable:!0,configurable:!0}),t.prototype.RebuildStateBuffer=function(){var t=new h.StateBuffer;this.Cpu.memoryMap.setupStateBuffer(t),this.Cpu.setupStateBuffer(t),this.ppu.setupStateBuffer(t),this.Cart.setupStateBuffer(t),t.build(),this.sb=t},t.prototype.Drawscreen=function(){},Object.defineProperty(t.prototype,"Cart",{get:function(){return this.Cpu&&this.Cpu.memoryMap&&this.Cpu.memoryMap.cart?this.Cpu.memoryMap.cart:void 0},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"EnableSound",{get:function(){return this._enableSound},set:function(t){this._enableSound=t,this._enableSound&&this.SoundBopper.rebuildSound()},enumerable:!0,configurable:!0}),t.prototype.Reset=function(){this.Cpu&&this.Cart&&this.Cart.supported&&(this.Cart.initializeCart(!0),this.Cpu.ResetCPU(),this.SoundBopper.rebuildSound(),this.RunState=i.RunningStatuses.Running)},t.prototype.PowerOn=function(){this.Cpu&&this.Cart&&this.Cart.supported&&(this.Cart.initializeCart(),this.Cpu.ppu.initialize(),this.SoundBopper.rebuildSound(),this.Cpu.PowerOn(),this.RunState=i.RunningStatuses.Running)},t.prototype.PowerOff=function(){this.RunState=i.RunningStatuses.Off},t.prototype.Step=function(){this.frameJustEnded&&(this.frameOn=!0,this.frameJustEnded=!1),this.Cpu.step(),this.frameOn||(this.totalCPUClocks=0,this.Cpu.Clock=0,this.ppu.LastcpuClock=0,this.frameJustEnded=!0)},t.prototype.RunFrame=function(){this.frameOn=!0,this.frameJustEnded=!1;do{this.Cpu.step()}while(this.frameOn);this.totalCPUClocks=0,this.Cpu.Clock=0,this.ppu.LastcpuClock=0},t.prototype.EjectCart=function(){this.Cpu.memoryMap=null},t.prototype.LoadNSF=function(t){},t.prototype.frameFinished=function(){this.frameJustEnded=!0,this.frameOn=!1,this.Drawscreen()},t.prototype.dispose=function(){},t}();e.ChiChiMachine=p},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e,s){this.onWriteAudio=e,this.handleDma=s,this.playing=!0,this.output=0,this.interruptRaised=!1,this.time=0,this.internalClock=0,this.isFetching=!1,this.buffer=0,this.bufferIsEmpty=!1,this.outbits=0,this.freqTable=[428,380,340,320,286,254,226,214,190,160,142,128,106,84,72,54],this.shiftreg=0,this.silenced=!1,this.cycles=0,this.nextRead=0,this.lengthCounter=0,this.length=0,this.address=0,this.interruptEnabled=0,this.frequency=0,this.loopFlag=0,this._chan=0,this._chan=t}return t.prototype.writeRegister=function(t,e,s){switch(t){case 0:this.frequency=15&e,this.loopFlag=e>>6&1,this.interruptEnabled=e>>7&1,0===this.interruptEnabled&&(this.interruptRaised=!1);break;case 1:this.output=127&e,this.onWriteAudio(this.time);break;case 2:this.address=e;break;case 3:this.length=e;break;case 4:this.interruptRaised=!1,e?this.lengthCounter||(this.nextRead=49152|this.address<<6&65535,this.lengthCounter=1+(this.length<<4)):this.lengthCounter=0}},t.prototype.run=function(t){if(!this.playing)return this.time=t,void(this.output=0);for(;this.time<t;this.time++)--this.cycles<=0&&(this.cycles=this.freqTable[this.frequency],this.silenced||(1&this.shiftreg?this.output<=125&&(this.output+=2,this.onWriteAudio(this.time)):this.output>=2&&(this.output-=2,this.onWriteAudio(this.time)),this.shiftreg>>=1),--this.outbits<=0&&(this.outbits=8,this.bufferIsEmpty?this.silenced=!0:(this.shiftreg=this.buffer,this.bufferIsEmpty=!0,this.silenced=!1))),this.bufferIsEmpty&&!this.isFetching&&this.lengthCounter&&(this.isFetching=!0,this.fetch(),this.lengthCounter--)},t.prototype.fetch=function(){this.buffer=this.handleDma(this.nextRead),this.bufferIsEmpty=!1,this.isFetching=!1,65536==++this.nextRead&&(this.nextRead=32768),this.lengthCounter||(this.loopFlag?(this.nextRead=49152|this.address<<6&65535,this.lengthCounter=1+(this.length<<4)):this.interruptEnabled&&(this.interruptRaised=!0))},t.prototype.endFrame=function(t){this.run(t),this.time=0},t}();e.DMCChannel=r},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.onWriteAudio=e,this.output=0,this.playing=!0,this.channelNumber=0,this.lengthCounts=new Uint8Array([10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30]),this.latchedLength=0,this.period=0,this.rawTimer=0,this.volume=0,this.time=0,this.envelope=0,this.looping=!1,this.enabled=!1,this.doodies=[2,6,30,249],this.sweepShift=0,this.sweepCounter=0,this.sweepDivider=0,this.sweepNegateFlag=!1,this.sweepEnabled=!1,this.startSweep=!1,this.sweepInvalid=!1,this.phase=0,this.envelopeTimer=0,this.envelopeStart=!1,this.envelopeConstantVolume=!1,this.envelopeVolume=0,this.sweepComplement=!1,this.dutyCycle=0,this.channelNumber=t,this.enabled=!0,this.sweepDivider=1,this.envelopeTimer=15}return t.prototype.writeRegister=function(t,e,s){switch(t){case 0:this.envelopeConstantVolume=16==(16&e),this.volume=15&e,this.dutyCycle=this.doodies[e>>6&3],this.looping=32==(32&e),this.sweepInvalid=!1;break;case 1:this.sweepShift=7&e,this.sweepNegateFlag=8==(8&e),this.sweepDivider=e>>4&7,this.sweepEnabled=128==(128&e),this.startSweep=!0,this.sweepInvalid=!1;break;case 2:this.period&=1792,this.period|=e,this.rawTimer=this.period;break;case 3:this.period&=255,this.period|=(7&e)<<8,this.rawTimer=this.period,this.phase=0,this.enabled&&(this.latchedLength=this.lengthCounts[e>>3&31]),this.envelopeStart=!0;break;case 4:this.enabled=0!==e,this.enabled||(this.latchedLength=0)}},t.prototype.run=function(t){if(!this.playing)return this.time=t,void(this.output=0);var e=this.sweepEnabled?(this.period+1&2047)<<1:(this.rawTimer+1&2047)<<1;if(0===e)return this.time=t,this.output=0,void this.onWriteAudio(this.time);var s=this.envelopeConstantVolume?this.volume:this.envelopeVolume;if(0===this.latchedLength||0===s||this.sweepInvalid)return this.phase+=(t-this.time)/e&7,this.output=0,void this.onWriteAudio(this.time);for(;this.time<t;this.time+=e,this.phase++)this.output=(this.dutyCycle>>(7&this.phase)&1)*s,this.onWriteAudio(this.time);this.phase&=7},t.prototype.endFrame=function(t){this.run(t),this.time=0},t.prototype.frameClock=function(t,e){switch(this.run(t),this.envelopeStart?(this.envelopeStart=!1,this.envelopeTimer=this.volume+1,this.envelopeVolume=15):(this.envelopeTimer--,0===this.envelopeTimer&&(this.envelopeTimer=this.volume+1,this.envelopeVolume>0?this.envelopeVolume--:this.envelopeVolume=this.looping?15:0)),e){case 1:case 3:if(--this.sweepCounter,0===this.sweepCounter&&(this.sweepCounter=this.sweepDivider+1,this.sweepEnabled&&this.sweepShift>0)){var s=this.period>>this.sweepShift;this.sweepComplement?this.period+=this.sweepNegateFlag?~s:s:this.period+=this.sweepNegateFlag?1+~s:s,this.sweepInvalid=this.rawTimer<8||2048==(2048&this.period)}this.startSweep&&(this.startSweep=!1,this.sweepCounter=this.sweepDivider+1),!this.looping&&this.latchedLength>0&&this.latchedLength--}},t}();e.SquareChannel=r},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.onWriteAudio=e,this.playing=!0,this.output=0,this._chan=0,this.lengthCounts=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30],this.length=0,this.period=0,this.time=0,this.envelope=0,this.looping=!1,this.enabled=!1,this.linCtr=0,this._phase=0,this._linVal=0,this.linStart=!1,this._chan=t,this.enabled=!0}return t.prototype.writeRegister=function(t,e,s){switch(t){case 0:this.looping=128==(128&e),this._linVal=127&e;break;case 1:break;case 2:this.period&=1792,this.period|=e;break;case 3:this.period&=255,this.period|=(7&e)<<8,this.enabled&&(this.length=this.lengthCounts[e>>3&31]),this.linStart=!0;break;case 4:this.enabled=0!==e,this.enabled||(this.length=0)}},t.prototype.run=function(t){if(!this.playing)return this.time=t,void(this.output=0);var e=this.period+1;if(0===this.linCtr||0===this.length||this.period<4)this.time=t;else for(;this.time<t;this.time+=e,this._phase=(this._phase+1)%32)this.output=this._phase<16?this._phase:31-this._phase,this.onWriteAudio(this.time)},t.prototype.endFrame=function(t){this.run(t),this.time=0},t.prototype.frameClock=function(t,e){switch(this.run(t),this.linStart?this.linCtr=this._linVal:this.linCtr>0&&this.linCtr--,this.looping||(this.linStart=!1),e){case 1:case 3:this.length>0&&!this.looping&&this.length--}},t}();e.TriangleChannel=r},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(){function t(t,e){this.onWriteAudio=e,this.playing=!0,this.output=0,this.period=0,this.enabled=!1,this.chan=0,this.noisePeriods=[4,8,16,32,64,96,128,160,202,254,380,508,762,1016,2034,4068],this.lengthCounts=[10,254,20,2,40,4,80,6,160,8,60,10,14,12,26,14,12,16,24,18,48,20,96,22,192,24,72,26,16,28,32,30],this.time=0,this.envConstantVolume=!1,this.envVolume=0,this.phase=0,this.envTimer=0,this.envStart=!1,this.length=0,this.volume=0,this.looping=!1,this.chan=t,this.phase=1,this.envTimer=15}return t.prototype.writeRegister=function(t,e,s){switch(t){case 0:this.envConstantVolume=16==(16&e),this.volume=15&e,this.looping=128==(128&e);break;case 1:break;case 2:this.period=this.noisePeriods[15&e];break;case 3:this.enabled&&(this.length=this.lengthCounts[e>>3&31]),this.envStart=!0;break;case 4:this.enabled=0!==e,this.enabled||(this.length=0)}},t.prototype.run=function(t){if(!this.playing)return this.time=t,void(this.output=0);var e=this.envConstantVolume?this.volume:this.envVolume;if(0===this.length&&(e=0),0===this.period)return this.time=t,this.output=0,void this.onWriteAudio(this.time);for(0===this.phase&&(this.phase=1);this.time<t;this.time+=this.period){var s=this.looping?1&this.phase^this.phase>>6&1:1&this.phase^this.phase>>1&1;this.output=this.phase&1*e,this.onWriteAudio(this.time),this.phase=65535&(this.phase>>1|s<<14)}},t.prototype.endFrame=function(t){this.run(t),this.time=0},t.prototype.frameClock=function(t,e){switch(this.run(t),this.envStart?(this.envStart=!1,this.envTimer=this.volume+1,this.envVolume=15):(this.envTimer--,0===this.envTimer&&(this.envTimer=this.volume+1,this.envVolume>0?this.envVolume--:this.envVolume=this.looping?15:0)),e){case 1:case 2:!this.looping&&this.length>0&&this.length--}},t}();e.NoiseChannel=r},function(e,s){e.exports=t},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=function(t){return function(t){return function(e){return function(s){return function(r){return function(i){return function(n){return function(a,o){var h=0;switch(61440&o){case 0:case 4096:h=o<2048?s[o]:o>>8;break;case 8192:case 12288:h=t.getByte(a,o);break;case 16384:switch(o){case 16405:h=e.GetByte(a,o);break;case 16406:h=r.getByte(a,o);break;case 16407:h=i.getByte(a,o);break;default:h=n.mapsBelow6000?n.getByte(a,o):o>>8}break;case 20480:h=o>>8;break;case 24576:case 28672:case 32768:case 36864:case 40960:case 45056:case 49152:case 53248:case 57344:case 61440:h=n.getByte(a,o);break;default:throw new Error("Bullshit!")}return 255&h}}}}}}}},i=function(t){return function(e){return function(s){return function(r){return function(i){return function(n){return function(a){return function(o,h,c){if(h<2048)r[2047&h]=c;else switch(61440&h){case 0:case 4096:r[2047&h]=c;break;case 20480:a.setByte(o,h,c);break;case 24576:case 28672:case 32768:case 36864:case 40960:case 45056:case 49152:case 53248:case 57344:case 61440:a.setByte(o,h,c);break;case 8192:case 12288:e.setByte(o,h,c);break;case 16384:switch(h){case 16384:case 16385:case 16386:case 16387:case 16388:case 16389:case 16390:case 16391:case 16392:case 16393:case 16394:case 16395:case 16396:case 16397:case 16398:case 16399:case 16400:case 16401:case 16402:case 16403:case 16405:case 16407:s.SetByte(o,h,c);break;case 16404:e.copySprites(256*c),t._currentInstruction_ExtraTiming=t._currentInstruction_ExtraTiming+513,1&o&&t._currentInstruction_ExtraTiming++;break;case 16406:i.setByte(o,h,1&c|64),n.setByte(o,h,1&c|64);break;default:a.mapsBelow6000&&a.setByte(o,h,c)}}}}}}}}}};e.setupMemoryMap=function(t){return function(e){return function(s){return function(n){return function(a){var o=new Uint8Array(new ArrayBuffer(8192*Uint8Array.BYTES_PER_ELEMENT)),h=[e,s],c=function(t){return t.onRestore.subscribe(function(t){o=t.getUint8Array("rams")}),t.pushSegment(8192*Uint8Array.BYTES_PER_ELEMENT,"rams"),t};return function(u){h.push(u);var p={getByte:r()(e)(s)(o)(n)(a),setByte:i(t)(e)(s)(o)(n)(a)},f={ppu:e,apu:s,pad1:n,pad2:a,cpu:t,Rams:o,cart:u,setupStateBuffer:c,getByte:p.getByte(u),setByte:p.setByte(u),getPPUByte:function(t,e){return u.getPPUByte(t,e)},setPPUByte:function(t,e,s){return u.setPPUByte(t,e,s)},irqRaised:function(){return u.irqRaised||s.interruptRaised},advanceClock:function(t){return h.forEach(function(e){return e.advanceClock(t)})},advanceScanline:function(t){for(;t-- >=0;)u.updateScanlineCounter()}};return t.memoryMap=s.memoryMap=e.memoryMap=f,f}}}}}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=["A","P","Z","L","G","I","T","Y","E","O","X","U","K","S","V","N"];e.ChiChiCheats={gameGenieCodeToPatch:function(t){var e=null,s=t.split("").map(function(t){return r.findIndex(function(e){return e===t})}),i=32768+((7&s[3])<<12)|(7&s[5])<<8|(8&s[4])<<8|(7&s[2])<<4|(8&s[1])<<4|7&s[4]|8&s[3],n=0;return 6==s.length?e={address:i,data:(7&s[1])<<4|(8&s[0])<<4|7&s[0]|8&s[5],compare:n,active:!0}:8==s.length&&(e={address:i,data:(7&s[1])<<4|(8&s[0])<<4|7&s[0]|8&s[7],compare:n=(7&s[7])<<4|(8&s[6])<<4|7&s[6]|8&s[5],active:!0}),e}}},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(4),i=function(){function t(){}return t.disassemble=function(t){if(!t||!t.OpCode)return"";var e=0;t.Parameters0.toString(16),t.Parameters1.toString(16);var s=t.Address.toString(16)+": ";switch(t.AddressingMode){case r.ChiChiCPPU_AddressingModes.Accumulator:case r.ChiChiCPPU_AddressingModes.Implicit:s+=this.getMnemnonic(t.OpCode);break;case r.ChiChiCPPU_AddressingModes.Immediate:s+=this.getMnemnonic(t.OpCode)+" #"+t.Parameters0.toString(16);break;case r.ChiChiCPPU_AddressingModes.ZeroPage:s+=this.getMnemnonic(t.OpCode)+" "+t.Parameters0.toString(16);break;case r.ChiChiCPPU_AddressingModes.ZeroPageX:s+=this.getMnemnonic(t.OpCode)+" "+t.Parameters0.toString(16)+", "+t.X.toString(16);break;case r.ChiChiCPPU_AddressingModes.ZeroPageY:s+=this.getMnemnonic(t.OpCode)+" "+t.Parameters0.toString(16)+", "+t.Y.toString(16);break;case r.ChiChiCPPU_AddressingModes.Relative:128==(128&t.Parameters0)?s+=this.getMnemnonic(t.OpCode)+" *"+t.Parameters0.toString(16):s+=this.getMnemnonic(t.OpCode)+" *+"+t.Parameters0.toString(16);break;case r.ChiChiCPPU_AddressingModes.Absolute:e=256*t.Parameters1|t.Parameters0,s+=this.getMnemnonic(t.OpCode)+" "+e.toString(16);break;case r.ChiChiCPPU_AddressingModes.AbsoluteX:e=256*t.Parameters1|t.Parameters0,s+=this.getMnemnonic(t.OpCode)+" "+e.toString(16)+","+t.X.toString(16);break;case r.ChiChiCPPU_AddressingModes.AbsoluteY:e=256*t.Parameters1|t.Parameters0,s+=this.getMnemnonic(t.OpCode)+" "+e.toString(16)+","+t.Y.toString(16);break;case r.ChiChiCPPU_AddressingModes.Indirect:e=256*t.Parameters1|t.Parameters0,s+=this.getMnemnonic(t.OpCode)+" ("+e.toString(16)+")";break;case r.ChiChiCPPU_AddressingModes.IndexedIndirect:s+=this.getMnemnonic(t.OpCode)+" ("+t.Parameters0.toString(16)+", "+t.X.toString(16);break;case r.ChiChiCPPU_AddressingModes.IndirectIndexed:s+=this.getMnemnonic(t.OpCode)+" ("+t.Parameters0.toString(16)+", "+t.Y.toString(16)}return s},t.getMnemnonic=function(t){switch(t){case 128:case 130:case 194:case 226:case 4:case 20:case 52:case 68:case 84:case 100:case 116:case 212:case 244:case 12:case 28:case 60:case 92:case 124:case 220:case 252:return"DOP";case 105:case 101:case 117:case 109:case 125:case 121:case 97:case 113:return"ADC";case 41:case 37:case 53:case 45:case 61:case 57:case 33:case 49:return"AND";case 10:case 6:case 22:case 14:case 30:return"ASL";case 144:return"BCC";case 176:return"BCS";case 240:return"BEQ";case 36:case 44:return"BIT";case 48:return"BMI";case 208:return"BNE";case 16:return"BPL";case 0:return"BRK";case 80:return"BVC";case 112:return"BVS";case 24:return"CLC";case 216:return"CLD";case 88:return"CLI";case 184:return"CLV";case 201:case 197:case 213:case 205:case 221:case 217:case 193:case 209:return"CMP";case 224:case 228:case 236:return"CPX";case 192:case 196:case 204:return"CPY";case 198:case 214:case 206:case 222:return"DEC";case 202:return"DEX";case 136:return"DEY";case 73:case 69:case 85:case 77:case 93:case 89:case 65:case 81:return"EOR";case 230:case 246:case 238:case 254:return"INC";case 232:return"INX";case 200:return"INY";case 76:case 108:return"JMP";case 32:return"JSR";case 169:case 165:case 181:case 173:case 189:case 185:case 161:case 177:return"LDA";case 162:case 166:case 182:case 174:case 190:return"LDX";case 160:case 164:case 180:case 172:case 188:return"LDY";case 74:case 70:case 86:case 78:case 94:return"LSR";case 234:case 26:case 58:case 90:case 122:case 218:case 250:case 137:return"NOP";case 9:case 5:case 21:case 13:case 29:case 25:case 1:case 17:return"ORA";case 72:return"PHA";case 8:return"PHP";case 104:return"PLA";case 40:return"PLP";case 42:case 38:case 54:case 46:case 62:return"ROL";case 106:case 102:case 118:case 110:case 126:return"ROR";case 64:return"RTI";case 96:return"RTS";case 235:case 233:case 229:case 245:case 237:case 253:case 249:case 225:case 241:return"SBC";case 56:return"SEC";case 248:return"SED";case 120:return"SEI";case 133:case 149:case 141:case 157:case 153:case 129:case 145:return"STA";case 134:case 150:case 142:return"STX";case 132:case 148:case 140:return"STY";case 170:return"TAX";case 168:return"TAY";case 186:return"TSX";case 138:return"TXA";case 154:return"TXS";case 152:return"TYA";case 11:case 43:return"AAC";case 75:return"ASR";case 107:return"ARR";case 171:return"ATX"}},t}();e.DebugHelpers=i},function(t,e,s){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var r=s(0),i=s(23),n=s(24),a=s(25),o=s(26),h=s(27),c=s(28),u=s(29),p=s(30),f=s(31),l=s(32),d=s(33),y=s(11),m=s(34),g=s(35),C=s(36),k=s(37),B=s(38),b=s(39),S=s(40),_=s(41),v=s(42),R=s(43),P={0:i.NesCart,1:o.MMC1Cart,2:i.UxROMCart,3:n.CNROMCart,4:c.MMC3Cart,7:i.AxROMCart,9:h.MMC2Cart,10:h.MMC4Cart,11:i.ColorDreams,13:i.Mapper013Cart,15:k.Mapper015Cart,21:y.Konami021Cart,22:y.KonamiVRC022Cart,23:y.KonamiVRC2Cart,24:m.Konami026Cart,25:y.Konami025Cart,26:m.Konami026Cart,30:i.Mapper030Cart,31:p.Mapper031Cart,34:C.BNROMCart,38:i.BitCorp038Cart,40:f.Smb2jCart,51:a.Mapper051Cart,58:a.Mapper058Cart,66:i.MHROMCart,68:u.Mapper068Cart,70:i.Mapper070Cart,71:i.Mapper071Cart,75:d.KonamiVRC1Cart,77:i.Mapper077Cart,78:i.Mapper078Cart,79:i.Mapper079Cart,81:i.Mapper081Cart,87:i.Mapper087Cart,89:g.Mapper089Cart,93:g.Mapper093Cart,94:i.Mapper094Cart,97:i.Irem097Cart,99:l.VSCart,112:B.Mapper112Cart,132:b.Mapper132Cart,133:S.Mapper133Cart,140:i.JF1xCart,145:i.Mapper145Cart,151:d.KonamiVRC1Cart,152:i.Mapper152Cart,180:i.NesCart,184:g.Mapper184Cart,190:i.Mapper190Cart,193:_.Mapper193Cart,202:a.Mapper202Cart,212:a.Mapper212Cart,228:v.Mapper228Cart};e.iNESFileHandler=function(t){return e=R.decodeFile(t),void 0!==P[e.mapperId]?new P[e.mapperId](e):new r.UnsupportedCart(e);var e}},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=s(0),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){switch(this.mapperId){case 0:this.mapperName="NROM";break;case 180:this.mapperName="UNROM (Crazy Climber?)"}this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=24576&&e<=32767)this.SRAMEnabled&&(this.prgRomBank6[8191&e]=255&s);else if(180===this.mapperId&&e>=32768){var r;r=2*s,this.setupBankStarts(this.current8,this.currentA,r,r+1|0)}},e}(n.BaseCart);e.NesCart=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="UxROM",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768){var r=s<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE)}},e}(n.BaseCart);e.UxROMCart=o;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="HVC-UN1ROM",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768){var r=(s>>2&7)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE)}},e}(n.BaseCart);e.Mapper094Cart=h;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Super Gun",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768){var r=(s>>2&3)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE);var i=3&s;this.copyBanks(t,0,i,1)}},e}(n.BaseCart);e.Mapper081Cart=c;var u=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="UNROM-512",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768){var r;r=(31&s)<<1,this.setupBankStarts(r,r+1|0,this.currentC,this.currentE);var i=s>>5&3;this.mirror(0,s>>7&1),this.copyBanks(t,0,i,1)}},e}(n.BaseCart);e.Mapper030Cart=u;var p=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Camerica UNROM",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768){var r;r=s<<1,this.setupBankStarts(r,r+1|0,this.currentC,this.currentE)}},e}(n.BaseCart);e.Mapper071Cart=p;var f=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="NES-CPROM",this.copyBanks4k(0,0,0,1),this.copyBanks4k(0,1,1,1),this.setupBankStarts(0,1,2,3),this.mirror(0,2)},e.prototype.setByte=function(t,e,s){e>=32768&&this.copyBanks4k(t,1,3&s,1)},e}(n.BaseCart);e.Mapper013Cart=f;var l=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="CNROM + CP",this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){e>=32768&&this.copyBanks(t,0,s,1)},e}(n.BaseCart);e.Mapper185Cart=l;var d=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="MKGGROM",this.usesSRAM=!0,this.copyBanks(0,0,0,2),this.setupBankStarts(0,1,0,1),this.mirror(0,1)},e.prototype.setByte=function(t,e,s){if(this.setPrgRam(e,s),e>=32768&&e<=40959){var r=(7&s)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE)}if(e>=40960&&e<=49151&&this.copyBanks2k(t,3&e,s,1),e>=49152&&e<=57343){r=8+(7&s)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE)}},e}(n.BaseCart);e.Mapper190Cart=d;var y=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="CNROM Clone",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=24576&&e<=32767){var r=(1&s)<<1|(2&s)>>1;this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.Mapper087Cart=y;var m=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Sachen Sidewinder",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(16640==(57600&e)){var r=s;this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.Mapper145Cart=m;var g=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Color Dreams",this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=(3&s)<<2,i=s>>4&15;this.setupBankStarts(r,r+1,r+2,r+3),this.copyBanks(t,0,i,1)}},e}(n.BaseCart);e.ColorDreams=g;var C=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="GxROM",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=3&s,i=(s>>4&3)<<2;this.setupBankStarts(i,i+1,i+2,i+3),this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.MHROMCart=C;var k=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="~Family Trainer",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.mirror(0,1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=15&s,i=(s>>4&15)<<1;this.setupBankStarts(i,i+1,this.currentC,this.currentE),this.copyBanks(t,0,r,1),this.oneScreenOffset=s>>7==1?1024:0,this.mirror(t,0)}},e}(n.BaseCart);e.Mapper070Cart=k;var B=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="~Mapper 077",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=(15&s)<<2,i=s>>4&15;this.setupBankStarts(r,r+1,r+2,r+3),this.copyBanks2k(t,0,i,1)}},e}(n.BaseCart);e.Mapper077Cart=B;var b=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapsBelow6000=!0,this.usesSRAM=!1,this.mapperName="NINA-003-006",this.chrRomCount>0&&this.copyBanks(0,0,0,2),this.setupBankStarts(2*this.prgRomCount-4,2*this.prgRomCount-3,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>>13==2&&256&e){var r=(s>>3&1)<<2;this.setupBankStarts(r,r+1,r+2,r+3);var i=7&s;this.copyBanks(t,0,i,1)}},e}(n.BaseCart);e.Mapper079Cart=b;var S=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isHolyDiver=!1,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Holy Diver / Cosmo Carrier",this.chrRomCount>0&&this.copyBanks(0,0,0,1),"BA51AC6F"==this.ROMHashFunction?(this.isHolyDiver=!0,this.mirror(0,1)):this.mirror(0,0),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=(15&s)<<1,i=s>>4&15,n=s>>3&1;this.setupBankStarts(r,r+1,this.currentC,this.currentE),this.copyBanks(t,0,i,1),this.isHolyDiver?0==n?this.mirror(t,2):this.mirror(t,1):(this.oneScreenOffset=1024*n,this.mirror(t,0))}},e}(n.BaseCart);e.Mapper078Cart=S;var _=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="~FT + onescreen mirroring",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.oneScreenOffset=0,this.mirror(0,0)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=15&s,i=(s>>4&49)<<1;this.setupBankStarts(i,i+1,this.currentC,this.currentE),this.copyBanks(t,0,r,1),this.oneScreenOffset=s>>7==1?1024:0,this.mirror(t,0)}},e}(n.BaseCart);e.Mapper152Cart=_;var v=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Jaleco JF-11, JF-14",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(e>=24576&&e<=32767){var r=15&s,i=(s>>4&3)<<2;this.setupBankStarts(i,i+1,i+2,i+3),this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.JF1xCart=v;var R=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="~Irem TAM-S1 IC",this.usesSRAM=!1,this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(2*this.prgRomCount-2,2*this.prgRomCount-1,0,1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r;switch(r=(15&s)<<1,this.setupBankStarts(this.current8,this.currentA,r,r+1),s>>6&3){case 0:this.oneScreenOffset=0,this.mirror(t,0);break;case 1:this.mirror(t,2);break;case 2:this.mirror(t,1);break;case 2:this.oneScreenOffset=1024,this.mirror(t,0)}}},e}(n.BaseCart);e.Irem097Cart=R;var P=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Bit Corp Crime Busters",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(e>=28672&&e<=32767){var r=(3&s)<<2,i=s>>2&3;this.setupBankStarts(r,r+1,r+2,r+3),this.copyBanks(t,0,i,1)}},e}(n.BaseCart);e.BitCorp038Cart=P;var A=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="AxROM",this.setupBankStarts(0,1,2,3),this.mirror(0,0)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r;r=(7&s)<<2,this.setupBankStarts(r,r+1,r+2,r+3),this.oneScreenOffset=16&s?1024:0,this.mirror(t,0)}},e}(n.BaseCart);e.AxROMCart=A},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="CNROM",this.usesSRAM=!1,1==this.prgRomCount?this.setupBankStarts(0,1,0,1):this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=15&s;this.copyBanks(t,0,r,1)}},e}(s(0).BaseCart);e.CNROMCart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=s(0),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.bank=0,e.mode=0,e}return i(e,t),e.prototype.initializeCart=function(){this.usesSRAM=!0,this.mapperName="Ball Games 11 in 1",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2,3)},e.prototype.updateBanks=function(){if(1&this.mode){var t=this.bank<<2;this.setupBankStarts(t,t+1,t+2,t+3),35}else{t=this.bank<<1;this.setupBankStarts(t,t+1,this.currentC,this.currentE),47}3==this.mode?this.mirror(0,1):this.mirror(0,2)},e.prototype.setByte=function(t,e,s){switch(57344&e){case 24576:this.mode=s>>3&2|s>>1&1,this.updateBanks();break;case 32768:this.bank=15&s,this.updateBanks();break;case 49152:this.bank=15&s,this.mode=s>>3&2|1&this.mode}},e}(n.BaseCart);e.Mapper051Cart=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Charlie Multi-Cart",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,2,3)},e.prototype.setByte=function(t,e,s){if(e>=32768){if(e>>6&1){var r=(7&e)<<1;this.setupBankStarts(r,r+1,r,r+1)}else{r=0;r=(7&e)<<2,this.setupBankStarts(r,r+1,r+2,r+3)}this.mirror(t,1+(e>>7&1)),this.copyBanks(t,0,e>>3&7,1)}},e}(n.BaseCart);e.Mapper058Cart=o;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Multi-Cart",this.chrRomCount>0&&this.copyBanks(0,0,0,1),this.setupBankStarts(0,1,0,1)},e.prototype.setByte=function(t,e,s){if(e>=32768){var r=e>>1&7;if(1&e|e>>2&2){var i=r>>1<<2;this.setupBankStarts(i,i+1,i+2,i+3)}else{i=r>>1<<1;this.setupBankStarts(i,i+1,i,i+1)}this.mirror(t,1+(1&e)),this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.Mapper202Cart=h;var c=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Multi-Cart212",this.chrRomCount>0&&this.copyBanks(0,0,0,2),this.setupBankStarts(0,1,3,4)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=7&e;if(1==(e>>14&1)){var i=(6&e)<<2;this.setupBankStarts(i,i+1,i+2,i+3)}else{i=r<<1;this.setupBankStarts(i,i+1,i,i+1)}this.mirror(t,1+(e>>3&1)),this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.Mapper212Cart=c},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chrRomBankMode=0,e.prgRomBankMode=0,e.lastClock=0,e.sequence=0,e.accumulator=0,e.bank_select=0,e._registers=new Array(4),e.lastwriteAddress=0,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="MMC1",this.usesSRAM=!0,this.mapsBelow6000=!1,this.ramMask=8191,this.chrRomCount>0&&this.copyBanks(0,0,0,2),this._registers[0]=12,this._registers[1]=0,this._registers[2]=0,this._registers[3]=0,this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.sequence=0,this.accumulator=0},e.prototype.setByte=function(t,e,s){switch(61440&e){case 24576:case 28672:this.prgRomBank6[8191&e]=255&s;break;default:if(this.lastwriteAddress=e,128==(128&s)?(this._registers[0]=12|this._registers[0],this.accumulator=0,this.sequence=0):(1==(1&s)&&(this.accumulator=this.accumulator|1<<this.sequence),this.sequence++),5===this.sequence){var r=(32767&e)>>13;switch(this._registers[r]=this.accumulator,this.sequence=0,this.accumulator=0,r){case 0:this.setMMC1Mirroring(t),this.prgRomBankMode=this._registers[0]>>2&3,this.chrRomBankMode=this._registers[0]>>4&1;break;case 1:case 2:this.setMMC1ChrBanking(t);break;case 3:this.setMMC1PrgBanking()}}}},e.prototype.setMMC1ChrBanking=function(t){1===this.chrRomBankMode?(this.copyBanks4k(t,0,this._registers[1],1),this.copyBanks4k(t,1,this._registers[2],1)):(this.copyBanks4k(t,0,this._registers[1],1),this.copyBanks4k(t,1,this._registers[1]+1,1))},e.prototype.setMMC1PrgBanking=function(){var t=0;32===this.prgRomCount?this.bank_select=(16&this._registers[1])<<1:this.bank_select=0,0==(8&this._registers[0])?(t=4*(this._registers[3]>>1&15)+this.bank_select,this.setupBankStarts(t,t+1,t+2,t+3)):(t=2*this._registers[3]+this.bank_select,4==(4&this._registers[0])?this.setupBankStarts(t,t+1,(this.prgRomCount<<1)-2,(this.prgRomCount<<1)-1):this.setupBankStarts(0,1,t,t+1))},e.prototype.setMMC1Mirroring=function(t){switch(3&this._registers[0]){case 0:this.oneScreenOffset=0,this.mirror(t,0);break;case 1:this.oneScreenOffset=1024,this.mirror(t,0);break;case 2:this.mirror(t,1);break;case 3:this.mirror(t,2)}},e}(s(0).BaseCart);e.MMC1Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=s(0),a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.latches=[0,0],e.banks=[0,0,0,0],e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="MMC2",this.latches[0]=1,this.latches[1]=2,this.banks[0]=0,this.banks[1]=0,this.banks[2]=0,this.banks[3]=0,this.setupBankStarts(0,2*this.prgRomCount-3,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,this.banks[this.latches[0]],1),this.copyBanks4k(0,1,this.banks[this.latches[1]],1)},e.prototype.getPPUByte=function(e,s){var r=0;return 4056==s?(r=s>>11&2,this.latches[0]=r,this.copyBanks4k(e,0,this.banks[this.latches[0]],1)):4072==s?(r=s>>11&2|1,this.latches[0]=r,this.copyBanks4k(e,0,this.banks[this.latches[0]],1)):s>=8152&&s<=8159?(r=s>>11&2,this.latches[1]=r,this.copyBanks4k(e,1,this.banks[this.latches[1]],1)):s>=8168&&s<=8175&&(r=s>>11&2|1,this.latches[1]=r,this.copyBanks4k(e,1,this.banks[this.latches[1]],1)),t.prototype.getPPUByte.call(this,e,s)},e.prototype.setByte=function(t,e,s){switch(e>>12){case 6:case 7:this.prgRomBank6[8191&e]=255&s;break;case 10:this.setupBankStarts(15&s,this.currentA,this.currentC,this.currentE);break;case 11:case 12:this.banks[e-45056>>12]=31&s,this.copyBanks4k(t,0,this.banks[this.latches[0]],1);break;case 13:case 14:this.banks[e-45056>>12]=31&s,this.copyBanks4k(t,1,this.banks[this.latches[1]],1);break;case 15:this.mirror(t,1+(1&s))}},e}(n.BaseCart);e.MMC2Cart=a;var o=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.selector=[0,0],e.banks=[0,0,0,0],e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="MMC4",this.selector[0]=1,this.selector[1]=2,this.banks[0]=0,this.banks[1]=0,this.banks[2]=0,this.banks[3]=0,this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,this.banks[this.selector[0]],1),this.copyBanks4k(0,1,this.banks[this.selector[1]],1)},e.prototype.getPPUByte=function(t,e){var s=0;e>=4056&&e<=4063?(s=e>>11&2,this.selector[0]=s,this.copyBanks4k(t,0,this.banks[this.selector[0]],1)):e>=4072&&e<=4079?(s=e>>11&2|1,this.selector[0]=s,this.copyBanks4k(t,0,this.banks[this.selector[0]],1)):e>=8152&&e<=8159?(s=e>>11&2,this.selector[1]=s,this.copyBanks4k(t,1,this.banks[this.selector[1]],1)):e>=8168&&e<=8175&&(s=e>>11&2|1,this.selector[1]=s,this.copyBanks4k(t,1,this.banks[this.selector[1]],1)),s=e>>10;var r=this.ppuBankStarts[s]+(1023&e);return this.chrRom[r]},e.prototype.setByte=function(t,e,s){switch(e>>12){case 6:case 7:this.SRAMEnabled&&this.SRAMCanWrite&&(this.prgRomBank6[8191&e]=255&s);break;case 10:var r=(15&s)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE);break;case 11:case 12:this.banks[e-45056>>12]=31&s,this.copyBanks4k(t,0,this.banks[this.selector[0]],1),this.Whizzler.unpackSprites();break;case 13:case 14:this.banks[e-45056>>12]=31&s,this.copyBanks4k(t,1,this.banks[this.selector[1]],1);break;case 15:this.mirror(t,1+(1&s))}},e}(n.BaseCart);e.MMC4Cart=o},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e._registers=new Uint8Array(4),e.chr2kBank0=0,e.chr2kBank1=1,e.chr1kBank0=0,e.chr1kBank1=0,e.chr1kBank2=0,e.chr1kBank3=0,e.prgSwap=0,e.prgSwitch1=0,e.prgSwitch2=0,e.prevBSSrc=new Uint8Array(8),e._mmc3Command=0,e._mmc3ChrAddr=0,e._mmc3IrqVal=0,e._mmc3TmpVal=0,e.scanlineCounter=0,e._mmc3IrcOn=!1,e.ppuBankSwap=!1,e.PPUBanks=new Uint32Array(8),e}return i(e,t),e.prototype.initializeCart=function(){this.usesSRAM=!0,this.mapperName="MMC3",this._registers.fill(0),this.PPUBanks.fill(0),this.prevBSSrc.fill(0),this.prgSwap=1,this.prgSwitch1=0,this.prgSwitch2=1,this.swapPrgBanks(),this._mmc3IrqVal=0,this._mmc3IrcOn=!1,this._mmc3TmpVal=0,this.chr2kBank0=0,this.chr2kBank1=0,this.chr1kBank0=0,this.chr1kBank1=0,this.chr1kBank2=0,this.chr1kBank3=0,this.chrRomCount>0&&this.copyBanks1k(0,0,0,8)},e.prototype.setByte=function(t,e,s){if(e>=24576&&e<32768)this.SRAMEnabled&&this.SRAMCanWrite&&(this.prgRomBank6[8191&e]=255&s);else switch(57345&e){case 32768:this._mmc3Command=7&s,128==(128&s)?(this.ppuBankSwap=!0,this._mmc3ChrAddr=4096):(this.ppuBankSwap=!1,this._mmc3ChrAddr=0),this.prgSwap=64==(64&s)?1:0,this.swapPrgBanks();break;case 32769:switch(this._mmc3Command){case 0:this.chr2kBank0=s,this.swapChrBanks();break;case 1:this.chr2kBank1=s,this.swapChrBanks();break;case 2:this.chr1kBank0=s,this.swapChrBanks();break;case 3:this.chr1kBank1=s,this.swapChrBanks();break;case 4:this.chr1kBank2=s,this.swapChrBanks();break;case 5:this.chr1kBank3=s,this.swapChrBanks();break;case 6:this.prgSwitch1=s,this.swapPrgBanks();break;case 7:this.prgSwitch2=s,this.swapPrgBanks()}break;case 40960:1==(1&s)?this.mirror(t,2):this.mirror(t,1);break;case 40961:this.SRAMCanWrite=0==(64&s),this.SRAMEnabled=128==(128&s);break;case 49152:this._mmc3IrqVal=s,0===s&&(this.scanlineCounter=0,this.irqRaised=!0);break;case 49153:this._mmc3TmpVal=this._mmc3IrqVal;break;case 57344:this._mmc3IrcOn=!1,this.irqRaised=!1;break;case 57345:this._mmc3IrcOn=!0}},e.prototype.swapChrBanks=function(){this.ppuBankSwap?(this.copyBanks1k(0,0,this.chr1kBank0,1),this.copyBanks1k(0,1,this.chr1kBank1,1),this.copyBanks1k(0,2,this.chr1kBank2,1),this.copyBanks1k(0,3,this.chr1kBank3,1),this.copyBanks1k(0,4,this.chr2kBank0,2),this.copyBanks1k(0,6,this.chr2kBank1,2)):(this.copyBanks1k(0,4,this.chr1kBank0,1),this.copyBanks1k(0,5,this.chr1kBank1,1),this.copyBanks1k(0,6,this.chr1kBank2,1),this.copyBanks1k(0,7,this.chr1kBank3,1),this.copyBanks1k(0,0,this.chr2kBank0,2),this.copyBanks1k(0,2,this.chr2kBank1,2))},e.prototype.swapPrgBanks=function(){1===this.prgSwap?this.setupBankStarts(2*this.prgRomCount-2,this.prgSwitch2,this.prgSwitch1,2*this.prgRomCount-1):this.setupBankStarts(this.prgSwitch1,this.prgSwitch2,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.updateScanlineCounter=function(){if(0===this.scanlineCounter){if(this.scanlineCounter=this._mmc3IrqVal,0===this._mmc3IrqVal)return this._mmc3IrcOn&&(this.irqRaised=!0),void(this.scanlineCounter=-1);this.scanlineCounter=this._mmc3IrqVal}0!==this._mmc3TmpVal?(this.scanlineCounter=this._mmc3TmpVal,this._mmc3TmpVal=0):this.scanlineCounter=this.scanlineCounter+1&255},e}(s(0).BaseCart);e.MMC3Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.cramStart=0,e.cromStart=0,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Sunsoft-4",this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.cramStart=this.chrRamStart},e.prototype.setByte=function(t,e,s){if(!(e<20480))if(e>=24576&&e<=32767)this.SRAMEnabled&&(this.prgRomBank6[8191&e]=255&s);else switch(61440&e){case 61440:var r=15*s<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE);break;case 32768:this.copyBanks2k(t,0,s,1);break;case 36864:this.copyBanks2k(t,1,s,1);break;case 40960:this.copyBanks2k(t,2,s,1);break;case 45056:this.copyBanks2k(t,3,s,1);break;case 49152:this.cromStart=1024*(128|s),this.chrRamStart=this.cromStart,this.copyBanks1k(t,8,128|s,1);break;case 53248:this.copyBanks1k(t,9,128|s,1);break;case 57344:var i=16==(16&s);this.chrRamStart=i?this.cramStart:this.cromStart,this.mirror(t,3&s)}},e}(s(0).BaseCart);e.Mapper068Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.mapsBelow6000=!0,e.registers=[0,0,0,0,0,0,0,255],e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="NSF Compilation",this.setupBanks4k(2,this.registers)},e.prototype.setByte=function(t,e,s){24560==(65520&e)&&(this.registers[7&e]=s,this.setupBanks4k(2,this.registers))},e}(s(0).BaseCart);e.Mapper031Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.irqEnabled=!1,e.irqCounter=0,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Smb2j pirate",this.usesSRAM=!1,this.setup6BankStarts(6,4,5,1,7),this.copyBanks(0,0,0,1)},e.prototype.advanceClock=function(t){this.irqEnabled&&(this.irqCounter-=t,this.irqCounter<=0&&(this.irqCounter=0,this.irqRaised=!0,this.irqEnabled=!1))},e.prototype.getByte=function(t,e){return this.prgRom[this.prgBankStarts[(e>>12)-6]+(4095&e)]},e.prototype.setByte=function(t,e,s){switch(57344&e){case 32768:this.irqRaised=!1,this.irqEnabled=!1;break;case 40960:this.irqEnabled=!0,this.irqCounter=4096,this.nextEventAt=t+4096;break;case 57344:this.setup6BankStarts(this.current6,this.current8,this.currentA,s,this.currentE)}},e}(s(0).BaseCart);e.Smb2jCart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.coin=0,e.dips1=0,e.dips2=0,e.customPalette=[430,326,44,660,0,755,14,630,555,310,70,3,764,770,4,572,737,200,27,747,0,222,510,740,653,53,447,140,403,0,473,357,503,31,420,6,407,507,333,704,22,666,36,20,111,773,444,707,757,777,320,700,760,276,777,467,0,750,637,567,360,657,77,120],e.reg16=0,e.bankSelect=0,e.clocks=0,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="VS Unisystem",this.mapsBelow6000=!0,this.setupBankStarts(0,2*this.prgRomCount-3,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks(0,0,0,1),this.mirror(0,3)},e.prototype.getByte=function(t,e){return 16416==e?this.coin:e>=32768?this.peekByte(e):void 0},e.prototype.setByte=function(t,e,s){if(this.setPrgRam(e,s),16406==e){this.bankSelect=s;var r=s>>2&1;this.prgRomCount>2&&this.setupBankStarts(r,2*this.prgRomCount-3,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks(t,0,r,1)}16416===e&&(this.coin=s)},e}(s(0).BaseCart);e.VSCart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.chrLatches=[0,0,0,0,0,0,0,0],e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="KonamiVRC1",151==this.mapperId&&(this.mapperName="KonamiVRC1 (VS)",this.fourScreen=!0,this.mirror(0,3)),this.setupBankStarts(0,0,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,0,2)},e.prototype.setByte=function(t,e,s){switch(61440&e){case 32768:var r=15&s;this.setupBankStarts(r,this.currentA,this.currentC,this.currentE);break;case 40960:var i=15&s;this.setupBankStarts(this.current8,i,this.currentC,this.currentE);break;case 49152:var n=15&s;this.setupBankStarts(this.current8,this.currentA,n,this.currentE);break;case 36864:this.fourScreen||(1==(1&s)?this.mirror(t,2):this.mirror(t,1)),this.chrLatches[0]=(s>>1&1)<<4,this.chrLatches[2]=(s>>2&1)<<4,this.syncChrBanks(t);break;case 57344:this.chrLatches[1]=15&s,this.syncChrBanks(t);break;case 61440:this.chrLatches[3]=15&s,this.syncChrBanks(t)}},e.prototype.syncChrBanks=function(t){this.copyBanks4k(t,0,this.chrLatches[0]|this.chrLatches[1],1),this.copyBanks4k(t,1,this.chrLatches[2]|this.chrLatches[3],1)},e}(s(0).BaseCart);e.KonamiVRC1Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.runCounter=!1,e.chrselect=0,e.chrA10Mode=!1,e.nameTableSource=!1,e.mirrorMode=0,e.bankMode=0,e.prgRamEnable=!1,e.swapMode=!1,e.microwireLatch=0,e.vrc6Registers=[0,0,0,0,0,0,0,0],e}return i(e,t),e.prototype.updateChrBanks=function(t){this.copyBanks1k(t,0,this.vrc6Registers[0],1);var e=this.vrc6Registers[1];switch(3&this.chrselect){case 1:e=this.vrc6Registers[0]}switch(this.copyBanks1k(t,1,e,1),e=this.vrc6Registers[2],3&this.chrselect){case 1:e=this.vrc6Registers[1]}switch(this.copyBanks1k(t,2,e,1),e=this.vrc6Registers[3],3&this.chrselect){case 1:e=this.vrc6Registers[1]}switch(this.copyBanks1k(t,3,e,1),e=this.vrc6Registers[4],3&this.chrselect){case 1:e=this.vrc6Registers[2]}switch(this.copyBanks1k(t,4,e,1),e=this.vrc6Registers[5],3&this.chrselect){case 1:e=this.vrc6Registers[2];break;case 2:case 3:e=this.vrc6Registers[4]}switch(this.copyBanks1k(t,5,e,1),e=this.vrc6Registers[6],3&this.chrselect){case 1:e=this.vrc6Registers[3];break;case 2:case 3:e=this.vrc6Registers[5]}switch(this.copyBanks1k(t,6,e,1),e=this.vrc6Registers[7],3&this.chrselect){case 1:e=this.vrc6Registers[3];break;case 2:case 3:e=this.vrc6Registers[5]}switch(this.copyBanks1k(t,7,e,1),7&this.chrselect){case 1:case 5:e=this.vrc6Registers[4];break;case 2:case 3:case 4:case 0:case 6:case 7:e=this.vrc6Registers[6]}switch(this.copyBanks1k(t,8,e,1),7&this.chrselect){case 1:case 5:e=this.vrc6Registers[5];break;case 2:case 3:case 4:e=this.vrc6Registers[7];break;case 0:case 6:case 7:e=this.vrc6Registers[6]}switch(this.copyBanks1k(t,9,e,1),7&this.chrselect){case 1:case 5:case 2:case 3:case 4:e=this.vrc6Registers[6];break;case 0:case 6:case 7:e=this.vrc6Registers[7]}this.copyBanks1k(t,10,e,1),this.copyBanks1k(t,11,this.vrc6Registers[7],1),this.chrselect},e.prototype.initializeCart=function(){this.mapperName="KonamiVRC6",this.setupBankStarts(0,0,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,0,2)},e.prototype.setByte=function(t,e,s){switch(61440&e){case 32768:if(e<=32771){var r=(15&s)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE)}break;case 49152:if(e<=49155){var i=15&s;this.setupBankStarts(this.current8,this.currentA,i,this.currentE)}break;case 45056:3==(3&e)&&(this.chrselect=s,this.prgRamEnable=128==(128&s),this.bankMode=3&s,this.mirrorMode=s>>2&3,this.nameTableSource=1==(s>>4&1),this.chrA10Mode=1==(s>>5&1),this.updateChrBanks(t));break;case 53248:e<=53251&&(this.vrc6Registers[3&e]=s,this.updateChrBanks(t));break;case 57344:e<=57347&&(this.vrc6Registers[4+(3&e)]=s,this.updateChrBanks(t));break;case 61440:switch(3&e){case 0:this.irqLatch=s;break;case 1:this.irqControl=s;break;case 2:this.ackIrq()}}},e}(s(11).VRCIrqBase);e.Konami026Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=s(0),a=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.usesSRAM=!0,this.mapperName="Sunsoft-2",this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=(s>>4&7)<<1;this.setupBankStarts(r,r+1,this.currentC,this.currentE)}},e}(n.BaseCart);e.Mapper093Cart=a;var o=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Sunsoft-2 on 3",this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r=7&s;r|=s>>4&8;var i=(s>>4&7)<<1;this.oneScreenOffset=8&s?1024:0,this.mirror(t,0),this.setupBankStarts(i,i+1,this.currentC,this.currentE),this.copyBanks(t,0,r,1)}},e}(n.BaseCart);e.Mapper089Cart=o;var h=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.usesSRAM=!1,this.mapperName="Sunsoft-1",this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks4k(0,0,3,1),this.copyBanks4k(0,1,0,1)},e.prototype.setByte=function(t,e,s){if(e>=24576&&e<=32767){var r=3&s,i=s>>4&15;this.copyBanks4k(t,0,r,1),this.copyBanks4k(t,1,i,1)}},e}(n.BaseCart);e.Mapper184Cart=h},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.isNina=!1,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="BNROM",this.setupBankStarts(0,1,2,3),this.chrRomCount>1&&(this.usesSRAM=!0,this.mapperName="NINA-001",this.isNina=!0,this.setByte=this.SetByteNina,this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1))},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535){var r;r=(15&s)<<2,this.setupBankStarts(r,r+1,r+2,r+3)}},e.prototype.SetByteNina=function(t,e,s){if(e>=24576&&e<=32767)this.prgRomBank6[8191&e]=255&s;else switch(e){case 32765:var r;r=(1&s)<<2,this.setupBankStarts(r,r+1,r+2,r+3);break;case 32766:this.copyBanks4k(t,0,15&s,1);break;case 32767:this.copyBanks4k(t,1,15&s,1)}},e}(s(0).BaseCart);e.BNROMCart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Contra 100-in-1",this.usesSRAM=!0,this.setupBankStarts(0,1,2,3),this.mirror(0,2)},e.prototype.setByte=function(t,e,s){if(e>=24576&&e<=65535)this.prgRomBank6[8191&e]=s;else if(e>=32768&&e<=65535){var r=3&e,i=63&s,n=s>>7&1,a=s>>6&1;switch(this.mirror(t,2-a),r){case 0:i<<=2,this.setupBankStarts(i^n,i+1^n,i+2^n,i+3^n);break;case 2:i|=n,this.setupBankStarts(i,i,i,i);break;case 1:case 3:i<<=1,i|=n,this.setupBankStarts(i,i+1,~e>>1&1,i+1)}}},e}(s(0).BaseCart);e.Mapper015Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registers=[0,0,0,0,0,0,0,0],e.latch=0,e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="asder",this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1)},e.prototype.updateBanks=function(){this.setupBankStarts(this.registers[0],this.registers[1],this.currentC,this.currentE),this.copyBanks2k(0,0,this.registers[2],1),this.copyBanks2k(0,1,this.registers[3],1),this.copyBanks1k(0,4,this.registers[4],1),this.copyBanks1k(0,5,this.registers[5],1),this.copyBanks1k(0,6,this.registers[6],1),this.copyBanks1k(0,7,this.registers[7],1)},e.prototype.setByte=function(t,e,s){if(e>=32768&&e<=65535)switch(57345&e){case 32768:this.latch=7&s;break;case 40960:this.registers[this.latch]=s,this.updateBanks();case 57344:this.mirror(t,1==(1&s)?1:2)}},e}(s(0).BaseCart);e.Mapper112Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.registers=[0,0,0,0],e}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Mapper 132",this.mapsBelow6000=!0,this.usesSRAM=!1,this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks(0,0,this.chrRomCount-1,1),this.mirror(0,1)},e.prototype.getByte=function(t,e){var s=(e>>12)-6;return e>=16640&&e<=16643?this.registers[1]^this.registers[2]|64:this.prgRom[this.prgBankStarts[s]+(4095&e)]},e.prototype.setByte=function(t,e,s){if(e>=16640&&e<=16643)this.registers[3&e]=s;else if(e>=32768&&e<=65535){var r=this.registers[2]<<2;this.setupBankStarts(r,r+1,r+2,r+3),this.copyBanks(t,0,this.registers[2],1)}},e}(s(0).BaseCart);e.Mapper132Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Jovial Race (Sachen)",this.usesSRAM=!1,this.mapsBelow6000=!0,this.setupBankStarts((this.prgRomCount<<1)-4,(this.prgRomCount<<1)-3,(this.prgRomCount<<1)-2,(this.prgRomCount<<1)-1),this.copyBanks(0,0,0,1),this.mirror(0,1)},e.prototype.setByte=function(t,e,s){if(e>=16640&&e<=24576){var r=3&s;this.copyBanks(t,0,r,1);var i=(s>>2&1)<<2;this.setupBankStarts(i,i+1,i+2,i+3)}},e}(s(0).BaseCart);e.Mapper133Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="NTDEC TC-112",this.usesSRAM=!1,this.setupBankStarts(0,2*this.prgRomCount-3,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks(0,0,this.chrRomCount-1,1),this.mirror(0,1)},e.prototype.setByte=function(t,e,s){if(console.log("set: 0x"+e.toString(16)+"( 0x"+s.toString(16)+")"),e>=24576&&e<=32767)switch(3&e){case 0:this.copyBanks4k(t,0,s>>2&63,1);break;case 1:this.copyBanks2k(t,2,s>>1,1);break;case 2:this.copyBanks2k(t,3,s>>1,1);break;case 3:this.setupBankStarts(s,this.currentA,this.currentC,this.currentE)}},e}(s(0).BaseCart);e.Mapper193Cart=n},function(t,e,s){"use strict";var r,i=this&&this.__extends||(r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var s in e)e.hasOwnProperty(s)&&(t[s]=e[s])},function(t,e){function s(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(s.prototype=e.prototype,new s)});Object.defineProperty(e,"__esModule",{value:!0});var n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return i(e,t),e.prototype.initializeCart=function(){this.mapperName="Cheetahmen II/Action 52",this.usesSRAM=!1,this.setupBankStarts(0,1,2*this.prgRomCount-2,2*this.prgRomCount-1),this.copyBanks(0,0,0,1),this.mirror(0,1),this.setByte(0,32768,0)},e.prototype.setByte=function(t,e,s){if(e>32768&&e<65535){var r=e>>5&1,i=3&s|(15&e)<<4,n=e>>5&1,a=e>>13&1,o=e>>6&31;if(this.copyBanks(t,0,i,1),n)o<<=2,this.setupBankStarts(o,o+1,o+2,o+3);else switch(r){case 1:o<<=1,this.setupBankStarts(o,o+1,o,o+1);case 0:var h=(254&o)<<1,c=(255&o)<<1;this.setupBankStarts(h,h+1,c,c+1)}this.mirror(t,2-a)}},e}(s(0).BaseCart);e.Mapper228Cart=n},function(t,e,s){"use strict";(function(t){Object.defineProperty(e,"__esModule",{value:!0});var r=s(48);e.decodeFile=function(e){var s,i,n=new Uint8Array(e,16),a=new Uint8Array(e,6,3),o=new Uint8Array(e,4,2),h=new Uint8Array(e,10,2),c=o[0],u=16384*c,p=o[1],f=8192*p,l=8==(8&a[0])?3:1==(1&a[0])?1:2,d=(i=240&(s=a)[0],i>>=4,i|=240&s[1],i|=(15&s[2])<<8);return{magicNumber:new Uint8Array(e,0,3),romCountArray:o,mapperBytes:a,ramCountArray:h,prgRom:new Uint8Array(e,16,u),chrRom:new Uint8Array(e,16+u,f),mapperId:d,submapperId:a[2]>>4,prgRomCount:c,prgRomLength:u,chrRomCount:p,chrRomLength:f,prgRamBanks:15&h[0],prgRamBanksBatteryBacked:h[0]>>4&15,chrRamBanks:15&h[1],chrRamBanksBatteryBacked:h[1]>>4&15,isPC10:2==(2&a[1]),isVS:1==(1&a[1]),usesSRAM:2==(2&a[0]),batterySRAM:2==(2&a[0]),mirroring:l,fourScreen:8==(8&a[0]),romCRC:r.crc32(new t(n)).toString(16).toUpperCase()}}}).call(e,s(1).Buffer)},function(t,e){var s;s=function(){return this}();try{s=s||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(s=window)}t.exports=s},function(t,e,s){"use strict";e.byteLength=function(t){return 3*t.length/4-c(t)},e.toByteArray=function(t){var e,s,r,a,o,h=t.length;a=c(t),o=new n(3*h/4-a),s=a>0?h-4:h;var u=0;for(e=0;e<s;e+=4)r=i[t.charCodeAt(e)]<<18|i[t.charCodeAt(e+1)]<<12|i[t.charCodeAt(e+2)]<<6|i[t.charCodeAt(e+3)],o[u++]=r>>16&255,o[u++]=r>>8&255,o[u++]=255&r;2===a?(r=i[t.charCodeAt(e)]<<2|i[t.charCodeAt(e+1)]>>4,o[u++]=255&r):1===a&&(r=i[t.charCodeAt(e)]<<10|i[t.charCodeAt(e+1)]<<4|i[t.charCodeAt(e+2)]>>2,o[u++]=r>>8&255,o[u++]=255&r);return o},e.fromByteArray=function(t){for(var e,s=t.length,i=s%3,n="",a=[],o=0,h=s-i;o<h;o+=16383)a.push(u(t,o,o+16383>h?h:o+16383));1===i?(e=t[s-1],n+=r[e>>2],n+=r[e<<4&63],n+="=="):2===i&&(e=(t[s-2]<<8)+t[s-1],n+=r[e>>10],n+=r[e>>4&63],n+=r[e<<2&63],n+="=");return a.push(n),a.join("")};for(var r=[],i=[],n="undefined"!=typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",o=0,h=a.length;o<h;++o)r[o]=a[o],i[a.charCodeAt(o)]=o;function c(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");return"="===t[e-2]?2:"="===t[e-1]?1:0}function u(t,e,s){for(var i,n,a=[],o=e;o<s;o+=3)i=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(255&t[o+2]),a.push(r[(n=i)>>18&63]+r[n>>12&63]+r[n>>6&63]+r[63&n]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(t,e){e.read=function(t,e,s,r,i){var n,a,o=8*i-r-1,h=(1<<o)-1,c=h>>1,u=-7,p=s?i-1:0,f=s?-1:1,l=t[e+p];for(p+=f,n=l&(1<<-u)-1,l>>=-u,u+=o;u>0;n=256*n+t[e+p],p+=f,u-=8);for(a=n&(1<<-u)-1,n>>=-u,u+=r;u>0;a=256*a+t[e+p],p+=f,u-=8);if(0===n)n=1-c;else{if(n===h)return a?NaN:1/0*(l?-1:1);a+=Math.pow(2,r),n-=c}return(l?-1:1)*a*Math.pow(2,n-r)},e.write=function(t,e,s,r,i,n){var a,o,h,c=8*n-i-1,u=(1<<c)-1,p=u>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,l=r?0:n-1,d=r?1:-1,y=e<0||0===e&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(o=isNaN(e)?1:0,a=u):(a=Math.floor(Math.log(e)/Math.LN2),e*(h=Math.pow(2,-a))<1&&(a--,h*=2),(e+=a+p>=1?f/h:f*Math.pow(2,1-p))*h>=2&&(a++,h/=2),a+p>=u?(o=0,a=u):a+p>=1?(o=(e*h-1)*Math.pow(2,i),a+=p):(o=e*Math.pow(2,p-1)*Math.pow(2,i),a=0));i>=8;t[s+l]=255&o,l+=d,o/=256,i-=8);for(a=a<<i|o,c+=i;c>0;t[s+l]=255&a,l+=d,a/=256,c-=8);t[s+l-d]|=128*y}},function(t,e){var s={}.toString;t.exports=Array.isArray||function(t){return"[object Array]"==s.call(t)}},function(t,e,s){"use strict";t.exports={crc1:s(49),crc8:s(50),crc81wire:s(51),crc16:s(52),crc16ccitt:s(53),crc16modbus:s(54),crc16xmodem:s(55),crc16kermit:s(56),crc24:s(57),crc32:s(58),crcjam:s(59)}},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}t.exports=(0,n.default)("crc1",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=~~e,n=0,a=0;a<t.length;a++){n+=t[a]}return(s+=n%256)%256})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,7,14,9,28,27,18,21,56,63,54,49,36,35,42,45,112,119,126,121,108,107,98,101,72,79,70,65,84,83,90,93,224,231,238,233,252,251,242,245,216,223,214,209,196,195,202,205,144,151,158,153,140,139,130,133,168,175,166,161,180,179,186,189,199,192,201,206,219,220,213,210,255,248,241,246,227,228,237,234,183,176,185,190,171,172,165,162,143,136,129,134,147,148,157,154,39,32,41,46,59,60,53,50,31,24,17,22,3,4,13,10,87,80,89,94,75,76,69,66,111,104,97,102,115,116,125,122,137,142,135,128,149,146,155,156,177,182,191,184,173,170,163,164,249,254,247,240,229,226,235,236,193,198,207,200,221,218,211,212,105,110,103,96,117,114,123,124,81,86,95,88,77,74,67,68,25,30,23,16,5,2,11,12,33,38,47,40,61,58,51,52,78,73,64,71,82,85,92,91,118,113,120,127,106,109,100,99,62,57,48,55,34,37,44,43,6,1,8,15,26,29,20,19,174,169,160,167,178,181,188,187,150,145,152,159,138,141,132,131,222,217,208,215,194,197,204,203,230,225,232,239,250,253,244,243];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("crc-8",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=~~e,n=0;n<t.length;n++){var a=t[n];s=255&o[255&(s^a)]}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,94,188,226,97,63,221,131,194,156,126,32,163,253,31,65,157,195,33,127,252,162,64,30,95,1,227,189,62,96,130,220,35,125,159,193,66,28,254,160,225,191,93,3,128,222,60,98,190,224,2,92,223,129,99,61,124,34,192,158,29,67,161,255,70,24,250,164,39,121,155,197,132,218,56,102,229,187,89,7,219,133,103,57,186,228,6,88,25,71,165,251,120,38,196,154,101,59,217,135,4,90,184,230,167,249,27,69,198,152,122,36,248,166,68,26,153,199,37,123,58,100,134,216,91,5,231,185,140,210,48,110,237,179,81,15,78,16,242,172,47,113,147,205,17,79,173,243,112,46,204,146,211,141,111,49,178,236,14,80,175,241,19,77,206,144,114,44,109,51,209,143,12,82,176,238,50,108,142,208,83,13,239,177,240,174,76,18,145,207,45,115,202,148,118,40,171,245,23,73,8,86,180,234,105,55,213,139,87,9,235,181,54,104,138,212,149,203,41,119,244,170,72,22,233,183,85,11,136,214,52,106,43,117,151,201,74,20,246,168,116,42,200,150,21,75,169,247,182,232,10,84,215,137,107,53];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("dallas-1-wire",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=~~e,n=0;n<t.length;n++){var a=t[n];s=255&o[255&(s^a)]}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("crc-16",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=~~e,n=0;n<t.length;n++){var a=t[n];s=65535&(o[255&(s^a)]^s>>8)}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,4129,8258,12387,16516,20645,24774,28903,33032,37161,41290,45419,49548,53677,57806,61935,4657,528,12915,8786,21173,17044,29431,25302,37689,33560,45947,41818,54205,50076,62463,58334,9314,13379,1056,5121,25830,29895,17572,21637,42346,46411,34088,38153,58862,62927,50604,54669,13907,9842,5649,1584,30423,26358,22165,18100,46939,42874,38681,34616,63455,59390,55197,51132,18628,22757,26758,30887,2112,6241,10242,14371,51660,55789,59790,63919,35144,39273,43274,47403,23285,19156,31415,27286,6769,2640,14899,10770,56317,52188,64447,60318,39801,35672,47931,43802,27814,31879,19684,23749,11298,15363,3168,7233,60846,64911,52716,56781,44330,48395,36200,40265,32407,28342,24277,20212,15891,11826,7761,3696,65439,61374,57309,53244,48923,44858,40793,36728,37256,33193,45514,41451,53516,49453,61774,57711,4224,161,12482,8419,20484,16421,28742,24679,33721,37784,41979,46042,49981,54044,58239,62302,689,4752,8947,13010,16949,21012,25207,29270,46570,42443,38312,34185,62830,58703,54572,50445,13538,9411,5280,1153,29798,25671,21540,17413,42971,47098,34713,38840,59231,63358,50973,55100,9939,14066,1681,5808,26199,30326,17941,22068,55628,51565,63758,59695,39368,35305,47498,43435,22596,18533,30726,26663,6336,2273,14466,10403,52093,56156,60223,64286,35833,39896,43963,48026,19061,23124,27191,31254,2801,6864,10931,14994,64814,60687,56684,52557,48554,44427,40424,36297,31782,27655,23652,19525,15522,11395,7392,3265,61215,65342,53085,57212,44955,49082,36825,40952,28183,32310,20053,24180,11923,16050,3793,7920];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("ccitt",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=void 0!==e?~~e:65535,n=0;n<t.length;n++){var a=t[n];s=65535&(o[255&(s>>8^a)]^s<<8)}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,49345,49537,320,49921,960,640,49729,50689,1728,1920,51009,1280,50625,50305,1088,52225,3264,3456,52545,3840,53185,52865,3648,2560,51905,52097,2880,51457,2496,2176,51265,55297,6336,6528,55617,6912,56257,55937,6720,7680,57025,57217,8e3,56577,7616,7296,56385,5120,54465,54657,5440,55041,6080,5760,54849,53761,4800,4992,54081,4352,53697,53377,4160,61441,12480,12672,61761,13056,62401,62081,12864,13824,63169,63361,14144,62721,13760,13440,62529,15360,64705,64897,15680,65281,16320,16e3,65089,64001,15040,15232,64321,14592,63937,63617,14400,10240,59585,59777,10560,60161,11200,10880,59969,60929,11968,12160,61249,11520,60865,60545,11328,58369,9408,9600,58689,9984,59329,59009,9792,8704,58049,58241,9024,57601,8640,8320,57409,40961,24768,24960,41281,25344,41921,41601,25152,26112,42689,42881,26432,42241,26048,25728,42049,27648,44225,44417,27968,44801,28608,28288,44609,43521,27328,27520,43841,26880,43457,43137,26688,30720,47297,47489,31040,47873,31680,31360,47681,48641,32448,32640,48961,32e3,48577,48257,31808,46081,29888,30080,46401,30464,47041,46721,30272,29184,45761,45953,29504,45313,29120,28800,45121,20480,37057,37249,20800,37633,21440,21120,37441,38401,22208,22400,38721,21760,38337,38017,21568,39937,23744,23936,40257,24320,40897,40577,24128,23040,39617,39809,23360,39169,22976,22656,38977,34817,18624,18816,35137,19200,35777,35457,19008,19968,36545,36737,20288,36097,19904,19584,35905,17408,33985,34177,17728,34561,18368,18048,34369,33281,17088,17280,33601,16640,33217,32897,16448];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("crc-16-modbus",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=void 0!==e?~~e:65535,n=0;n<t.length;n++){var a=t[n];s=65535&(o[255&(s^a)]^s>>8)}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}t.exports=(0,n.default)("xmodem",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=void 0!==e?~~e:0,n=0;n<t.length;n++){var a=s>>>8&255;a^=255&t[n],s=s<<8&65535,s^=a^=a>>>4,s^=a=a<<5&65535,s^=a=a<<7&65535}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,4489,8978,12955,17956,22445,25910,29887,35912,40385,44890,48851,51820,56293,59774,63735,4225,264,13203,8730,22181,18220,30135,25662,40137,36160,49115,44626,56045,52068,63999,59510,8450,12427,528,5017,26406,30383,17460,21949,44362,48323,36440,40913,60270,64231,51324,55797,12675,8202,4753,792,30631,26158,21685,17724,48587,44098,40665,36688,64495,60006,55549,51572,16900,21389,24854,28831,1056,5545,10034,14011,52812,57285,60766,64727,34920,39393,43898,47859,21125,17164,29079,24606,5281,1320,14259,9786,57037,53060,64991,60502,39145,35168,48123,43634,25350,29327,16404,20893,9506,13483,1584,6073,61262,65223,52316,56789,43370,47331,35448,39921,29575,25102,20629,16668,13731,9258,5809,1848,65487,60998,56541,52564,47595,43106,39673,35696,33800,38273,42778,46739,49708,54181,57662,61623,2112,6601,11090,15067,20068,24557,28022,31999,38025,34048,47003,42514,53933,49956,61887,57398,6337,2376,15315,10842,24293,20332,32247,27774,42250,46211,34328,38801,58158,62119,49212,53685,10562,14539,2640,7129,28518,32495,19572,24061,46475,41986,38553,34576,62383,57894,53437,49460,14787,10314,6865,2904,32743,28270,23797,19836,50700,55173,58654,62615,32808,37281,41786,45747,19012,23501,26966,30943,3168,7657,12146,16123,54925,50948,62879,58390,37033,33056,46011,41522,23237,19276,31191,26718,7393,3432,16371,11898,59150,63111,50204,54677,41258,45219,33336,37809,27462,31439,18516,23005,11618,15595,3696,8185,63375,58886,54429,50452,45483,40994,37561,33584,31687,27214,22741,18780,15843,11370,7921,3960];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("kermit",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=void 0!==e?~~e:0,n=0;n<t.length;n++){var a=t[n];s=65535&(o[255&(s^a)]^s>>8)}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,8801531,9098509,825846,9692897,1419802,1651692,10452759,10584377,2608578,2839604,11344079,3303384,11807523,12104405,4128302,12930697,4391538,5217156,13227903,5679208,13690003,14450021,5910942,6606768,14844747,15604413,6837830,16197969,7431594,8256604,16494759,840169,9084178,8783076,18463,10434312,1670131,1434117,9678590,11358416,2825259,2590173,10602790,4109873,12122826,11821884,3289031,13213536,5231515,4409965,12912278,5929345,14431610,13675660,5693559,6823513,15618722,14863188,6588335,16513208,8238147,7417269,16212302,1680338,10481449,9664223,1391140,9061683,788936,36926,8838341,12067563,4091408,3340262,11844381,2868234,11372785,10555655,2579964,14478683,5939616,5650518,13661357,5180346,13190977,12967607,4428364,8219746,16457881,16234863,7468436,15633027,6866552,6578062,14816117,1405499,9649856,10463030,1698765,8819930,55329,803287,9047340,11858690,3325945,4072975,12086004,2561507,10574104,11387118,2853909,13647026,5664841,5958079,14460228,4446803,12949160,13176670,5194661,7454091,16249200,16476294,8201341,14834538,6559633,6852199,15647388,3360676,11864927,12161705,4185682,10527045,2551230,2782280,11286707,9619101,1346150,1577872,10379115,73852,8875143,9172337,899466,16124205,7357910,8182816,16421083,6680524,14918455,15678145,6911546,5736468,13747439,14507289,5968354,12873461,4334094,5159928,13170435,4167245,12180150,11879232,3346363,11301036,2767959,2532769,10545498,10360692,1596303,1360505,9604738,913813,9157998,8856728,92259,16439492,8164415,7343561,16138546,6897189,15692510,14936872,6662099,5986813,14488838,13733104,5750795,13156124,5174247,4352529,12855018,2810998,11315341,10498427,2522496,12124823,4148844,3397530,11901793,9135439,862644,110658,8912057,1606574,10407765,9590435,1317464,15706879,6940164,6651890,14889737,8145950,16384229,16161043,7394792,5123014,13133629,12910283,4370992,14535975,5997020,5707818,13718737,2504095,10516836,11329682,2796649,11916158,3383173,4130419,12143240,8893606,129117,876971,9121104,1331783,9576124,10389322,1625009,14908182,6633453,6925851,15721184,7380471,16175372,16402682,8127489,4389423,12891860,13119266,5137369,13704398,5722165,6015427,14517560];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("crc-24",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=void 0!==e?~~e:11994318,n=0;n<t.length;n++){var a=t[n];s=16777215&(o[255&(s>>16^a)]^s<<8)}return s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("crc-32",function(t,e){r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=0===e?0:-1^~~e,n=0;n<t.length;n++){var a=t[n];s=o[255&(s^a)]^s>>>8}return-1^s})},function(t,e,s){"use strict";var r=s(1),i=a(s(2)),n=a(s(3));function a(t){return t&&t.__esModule?t:{default:t}}var o=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918e3,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];"undefined"!=typeof Int32Array&&(o=new Int32Array(o)),t.exports=(0,n.default)("jam",function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1;r.Buffer.isBuffer(t)||(t=(0,i.default)(t));for(var s=0===e?0:~~e,n=0;n<t.length;n++){var a=t[n];s=o[255&(s^a)]^s>>>8}return s})}])});